!function(m){"use strict";Object.is||(Object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}),"function"!=typeof DataTransfer.prototype.setDragImage&&(DataTransfer.prototype.setDragImage=function(e,t,n){});var t,n,o=o||function(l){if(!(void 0===l||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=l.document,c=function(){return l.URL||l.webkitURL||l},s=e.createElementNS("http://www.w3.org/1999/xhtml","a"),u="download"in s,p=/constructor/i.test(l.HTMLElement),f=/CriOS\/[\d]+/.test(navigator.userAgent),d=function(e){(l.setImmediate||l.setTimeout)(function(){throw e},0)},g=function(e){setTimeout(function(){"string"==typeof e?c().revokeObjectURL(e):e.remove()},4e4)},h=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},i=function(e,n,t){t||(e=h(e));var i,a=this,o="application/octet-stream"===e.type,r=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var a=e["on"+t[i]];if("function"==typeof a)try{a.call(e,n||e)}catch(e){d(e)}}}(a,"writestart progress write writeend".split(" "))};if(a.readyState=a.INIT,u)return i=c().createObjectURL(e),void setTimeout(function(){var e,t;s.href=i,s.download=n,e=s,t=new MouseEvent("click"),e.dispatchEvent(t),r(),g(i),a.readyState=a.DONE});!function(){if((f||o&&p)&&l.FileReader){var t=new FileReader;return t.onloadend=function(){var e=f?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");l.open(e,"_blank")||(l.location.href=e),e=void 0,a.readyState=a.DONE,r()},t.readAsDataURL(e),a.readyState=a.INIT}i||(i=c().createObjectURL(e)),o?l.location.href=i:l.open(i,"_blank")||(l.location.href=i);a.readyState=a.DONE,r(),g(i)}()},t=i.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=h(e)),navigator.msSaveOrOpenBlob(e,t)}:(t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,function(e,t,n){return new i(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=o:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define([],function(){return o}),m("#ipages-app-items").length?m(".ipages .ipages-toggle").on("click touchend",function(e){e.stopPropagation(),e.preventDefault();var t=m(this),n=t.data("id"),i=null;if(!t.hasClass("ipages-locked")){t.addClass("ipages-readonly"),t.hasClass("ipages-checked")?(t.removeClass("ipages-checked").addClass("ipages-unchecked"),i=!1):(t.removeClass("ipages-unchecked").addClass("ipages-checked"),i=!0);var a=ipages_flipbook.ajax_url,o=ipages_flipbook.ajax_nonce,r=ipages_flipbook.ajax_action_update,l=ipages_flipbook.ajax_msg_error,c={id:n,active:i},s=m.extend(!0,{},c);s=JSON.stringify(s),m.ajax({url:a,type:"POST",dataType:"json",data:{nonce:o,action:r,config:s}}).done(function(e){e&&!e.success&&(i?t.removeClass("ipages-checked").addClass("ipages-unchecked"):t.removeClass("ipages-unchecked").addClass("ipages-checked"))}).fail(function(){console.log(l)}).always(function(){t.removeClass("ipages-readonly")})}}):m("#ipages-app-item").length?(n={alight:null,rootScope:null,$audio:null,wpFileFramePageImages:null,wpFileFramePageImage:null,wpFileFrameBackgroundImage:null,wpFileFrameLayerBackgroundImage:null,wpFileFrameFlipSound:null,wpFileFramePDFDocument:null,wp_upload_url:null,wp_ajax_url:null,wp_ajax_nonce:null,wp_ajax_action_update:null,wp_ajax_action_get:null,wp_ajax_msg_error:null,wp_item_id:null,bookThemes:null,pdfTimerId:null,pdfLoading:null,pdf:null,pdfPageWidth:0,pdfPageHeight:0,pageStatus:new WeakMap,settings:{themeJavaScript:null,themeCSS:null,pdfProgressiveLoading:!1},config:{title:null,active:!0,bookEngine:"TwoPageFlip",pageWidth:300,pageHeight:360,pageStart:1,pdfUrl:null,pdfAutoCreatePages:!1,pdfBookSizeFromDocument:!1,pdfProgressiveLoading:!1,preloadNeighbours:!1,responsive:!0,autoFit:!1,flipSound:!0,flipSoundUrl:null,flipDuration:300,bookTheme:"dark",bookClass:null,bookEnginePortrait:null,bookEngineLandscape:null,ratioPortraitToLandscape:1.3,autoWidth:!0,autoHeight:!0,containerHeight:null,containerWidth:null,padding:{top:10,right:10,bottom:10,left:10},perspective:1500,backgroundColor:null,backgroundImage:{relative:!0,url:null},backgroundSize:null,backgroundRepeat:null,backgroundPosition:null,prevnextButtons:!0,mouseDragNavigation:!0,mousePageClickNavigation:!1,touchNavigation:!0,keyboardNavigation:!0,mouseWheelNavigation:!1,mouseWheelPreventDefault:!1,zoom:1,zoomMax:7,zoomMin:1,zoomStep:.05,zoomFocal:!0,dblClickZoomDefault:!1,mouseWheelZoom:!0,keyboardZoom:!0,pinchZoom:!0,pinchZoomCoef:.005,pageNumbers:!1,pageNumbersFirst:1,pageNumbersHidden:null,pages:[],toolbar:!0,toolbarControls:[{type:"share",active:!0,title:"share",icon:"ipages-icon ipages-icon-share",optional:!1},{type:"outline",active:!0,title:"toggle outline/bookmark",icon:"ipages-icon ipages-icon-outline",optional:!1},{type:"thumbnails",active:!0,title:"toggle thumbnails",icon:"ipages-icon ipages-icon-thumbnails",optional:!1},{type:"gotofirst",active:!1,title:"goto first page",icon:"ipages-icon ipages-icon-gotofirst",optional:!1},{type:"prev",active:!0,title:"prev page",icon:"ipages-icon ipages-icon-prev",optional:!1},{type:"pagenumber",active:!0,title:"goto page number",icon:"ipages-icon ipages-icon-pagenumber",optional:!1},{type:"next",active:!0,title:"next page",icon:"ipages-icon ipages-icon-next",optional:!1},{type:"gotolast",active:!1,title:"goto last page",icon:"ipages-icon ipages-icon-gotolast",optional:!1},{type:"zoom-in",active:!0,title:"zoom in",icon:"ipages-icon ipages-icon-zoom-in",optional:!1},{type:"zoom-out",active:!0,title:"zoom out",icon:"ipages-icon ipages-icon-zoom-out",optional:!1},{type:"zoom-default",active:!0,title:"zoom default",icon:"ipages-icon ipages-icon-zoom-default",optional:!1},{type:"optional",active:!0,title:"optional",icon:"ipages-icon ipages-icon-more",optional:!1},{type:"fullscreen",active:!0,title:"toggle fullscreen",icon:"ipages-icon ipages-icon-fullscreen",optional:!0},{type:"sound",active:!0,title:"turn on/off flip sound",icon:"ipages-icon ipages-icon-sound",optional:!0},{type:"download",active:!0,title:"download pdf",icon:"ipages-icon ipages-icon-download",optional:!0}],autoEnableThumbnails:!1,autoEnableOutline:!1,autoEnableShare:!1,bookmarks:[],customCSS:{active:!1,data:null},customJS:{active:!1,data:null}},ui:{fullscreen:!1,selectedPages:[],activePage:null,editPage:null,editPageZoom:null,mapLayers:null,activeLayer:null,editLayer:{type:null,initX:null,initY:null,lastX:null,lastY:null,centerX:null,centerY:null,rotation:0,layerAngle:null,layerX:null,layerY:null,layerWidth:null,layerHeight:null},activeBookControl:null,editBookControl:null,activeBookmark:null,editBookmark:null,tabs:{general:!0,pages:!1,customCSS:!1,customJS:!1,shortcode:!1},generalTab:{settings:!1,pdf:!0,view:!0,zoom:!0,navigation:!0,toolbar:!0,bookmarks:!0},pageTabs:{page:!0,layers:!1,layer:!1},layerTab:{common:!0,special:!1}},defaultBookmark:{active:!0,level:0,text:"",link:"",target:"page"},defaultPage:{active:!0,title:null,pdfPageNumber:null,image:{relative:!0,url:null},showCSSClass:null,hideCSSClass:null,userData:null,layers:[],dirty:!1},defaultLayer:{type:"link",title:null,x:0,y:0,width:150,height:100,angle:0,lock:!1,visible:!0,elementClass:null,link:{url:null,newWindow:!1,normalColor:null,hoverColor:null,clickColor:null,radius:0},image:{backgroundImage:{relative:!0,url:null},backgroundSize:null,backgroundRepeat:null,backgroundPosition:null},text:{data:null,color:"#000",size:18,lineHeight:18,align:null,letterSpacing:null}},fn:{init:function(o){o.fn.enableLoading(o);var e,t=m("#ipages-app-item");if(t.removeAttr("style"),t.on("fullscreenchange mozfullscreenchange webkitfullscreenchange msfullscreenchange",m.proxy(o.fn.onFullScreenChange,this,o)),m(window).on("resize",m.proxy(o.fn.onResize,this,o)),o.plan=ipages_flipbook.plan,o.wp_upload_url=ipages_flipbook.upload_url,o.wp_ajax_url=ipages_flipbook.ajax_url,o.wp_ajax_nonce=ipages_flipbook.ajax_nonce,o.wp_ajax_action_update=ipages_flipbook.ajax_action_update,o.wp_ajax_action_get=ipages_flipbook.ajax_action_get,o.wp_ajax_msg_error=ipages_flipbook.ajax_msg_error,o.msg_pro_title=ipages_flipbook.msg_pro_title,o.msg_edit_text=ipages_flipbook.msg_edit_text,o.msg_custom_js_error=ipages_flipbook.msg_custom_js_error,o.wp_item_id=ipages_flipbook.ajax_item_id,ipages_flipbook.config&&(e=m.extend(!0,{},JSON.parse(ipages_flipbook.config))))for(var n in e)o.config.hasOwnProperty(n)&&(o.config[n]=e[n]);if(ipages_flipbook.settings&&(e=m.extend(!0,{},JSON.parse(ipages_flipbook.settings))))for(var n in e)o.settings.hasOwnProperty(n)&&(o.settings[n]=e[n]);PDFJS.disableAutoFetch=!0,PDFJS.disableStream=!0,PDFJS.disableRange=!o.settings.pdfProgressiveLoading,PDFJS.externalLinkTarget=PDFJS.LinkTarget.BLANK,o.rootScope.watch("appData.config.pdfUrl",function(t){clearTimeout(o.pdfTimerId),o.pdfTimerId=setTimeout(function(){if(o.pdfLoading&&(o.pdfLoading.destroy(),o.pdfLoading=null),o.pdf&&(o.pdf.destroy(),o.pdf=null),o.pdfPageWidth=0,o.pdfPageHeight=0,null!=t){var n=m("#ipages-pdf-loading"),i=n.find(".ipages-pdf-loading-percent");i.text("0%"),n.addClass("ipages-active"),o.pdfLoading=PDFJS.getDocument(t),o.pdfLoading.then(function(e){(o.pdf=e).getPage(1).then(function(e){var t=e.getViewport(1),n=parseInt(t.width,10),i=parseInt(t.height,10);o.pdfPageWidth=n,o.pdfPageHeight=i;for(var a=0;a<o.config.pages.length;a++)o.config.pages[a].dirty=!o.config.pages[a].dirty;o.rootScope.scan()}),o.fn.showNotice(o,'PDF ready "'+t+'"',"notice-success"),n.removeClass("ipages-active")},function(e){console.error(e.message);for(var t=0;t<o.config.pages.length;t++)o.config.pages[t].dirty=!o.config.pages[t].dirty;o.rootScope.scan(),o.fn.showNotice(o,e.message,"notice-error"),n.removeClass("ipages-active")}),o.pdfLoading.onProgress=function(e){var t=100*e.loaded/e.total;isNaN(t)?e&&e.loaded?i.text((Math.ceil(e.loaded/1e4)/100).toString()+"Mb"):i.text(""):i.text(t.toString().split(".")[0]+"%")}}},1500)}),o.fn.loadBookThemes(o).done(function(e){o.bookThemes=e}).always(function(){o.rootScope.scan(),o.fn.disableLoading(o)})},enableLoading:function(e){m("#ipages-app-item").removeClass("ipages-active")},disableLoading:function(e){setTimeout(function(){m("#ipages-app-item").addClass("ipages-active")},1e3)},loadBookThemes:function(i){var a=m.Deferred();return m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_get,type:"book-themes"},success:function(e){e&&e.success?a.resolve(e.data.list):this.error()},error:function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error"),a.resolve(null)}}),a.promise()},getPluginConfig:function(t){var e={};t.config.bookEngine&&(e.bookEngine=t.config.bookEngine),e.bookEnginePortrait=t.config.bookEnginePortrait,e.bookEngineLandscape=t.config.bookEngineLandscape,e.ratioPortraitToLandscape=t.config.ratioPortraitToLandscape,e.bookTheme=null,e.pageWidth=t.config.pageWidth,e.pageHeight=t.config.pageHeight,e.pageStart=t.config.pageStart,e.pdfUrl=t.config.pdfUrl,e.pdfAutoCreatePages=t.config.pdfAutoCreatePages,e.pdfBookSizeFromDocument=t.config.pdfBookSizeFromDocument,e.pdfDisableRangeRequests=!t.config.pdfProgressiveLoading,e.preloadNeighbours=t.config.preloadNeighbours,e.responsive=t.config.responsive,e.autoFit=t.config.autoFit,e.flipSound=t.config.flipSound,e.flipSoundUrl=t.config.flipSoundUrl,e.perspective=t.config.perspective,e.autoHeight=t.config.autoHeight,e.padding={top:t.config.padding.top,right:t.config.padding.right,bottom:t.config.padding.bottom,left:t.config.padding.left},e.flipDuration=t.config.flipDuration,e.pageNumbers=t.config.pageNumbers,e.pageNumbersFirst=t.config.pageNumbersFirst,e.pageNumbersHidden=t.config.pageNumbersHidden?t.config.pageNumbersHidden.split(";"):[];for(var n=0;n<e.pageNumbersHidden.length;n++)e.pageNumbersHidden[n]=parseInt(e.pageNumbersHidden[n],10);e.prevnextButtons=t.config.prevnextButtons,e.mouseDragNavigation=t.config.mouseDragNavigation,e.mousePageClickNavigation=t.config.mousePageClickNavigation,e.touchNavigation=t.config.touchNavigation,e.keyboardNavigation=t.config.keyboardNavigation,e.mouseWheelNavigation=t.config.mouseWheelNavigation,e.mouseWheelPreventDefault=t.config.mouseWheelPreventDefault,e.zoom=t.config.zoom,e.zoomMax=t.config.zoomMax,e.zoomMin=t.config.zoomMin,e.zoomStep=t.config.zoomStep,e.zoomFocal=t.config.zoomFocal,e.dblClickZoomDefault=t.config.dblClickZoomDefault,e.mouseWheelZoom=t.config.mouseWheelZoom,e.keyboardZoom=t.config.keyboardZoom,e.pinchZoom=t.config.pinchZoom,e.pinchZoomCoef=t.config.pinchZoomCoef,e.toolbar=t.config.toolbar,e.toolbarControls=m.extend(!0,[],t.config.toolbarControls),e.autoEnableThumbnails=t.config.autoEnableThumbnails,e.autoEnableOutline=t.config.autoEnableOutline,e.autoEnableShare=t.config.autoEnableShare,e.bookmarks=[];var i=m.extend(!0,[],t.config.bookmarks);for(n=0;n<i.length;n++){var a=i[n];a.id=n,a.hasOwnProperty("parent")||(a.parent=null);for(var o=n+1;o<i.length;o++){var r=i[o];if(r.level>a.level&&(r.parent=a),r.level<a.level)break}}function l(e,t,n,i){for(var a=e+1;a<i.length;a++)if(i[a].parent&&t.id==i[a].parent.id){var o=i[a],r={text:o.text,link:o.link,target:o.target,bookmarks:[]};o.active&&(l(a,o,r,i),n.bookmarks.push(r))}}for(n=0;n<i.length;n++){var c=i[n],s={text:c.text,link:c.link,target:c.target,bookmarks:[]};c.active&&(l(n,c,s,i),null==c.parent&&e.bookmarks.push(s))}if(t.config.customJS.active){e.onLoad=t.config.customJS.data;try{new Function(e.onLoad)}catch(e){t.fn.showNotice(t,t.msg_custom_js_error+": "+e.message,"notice-error")}}return e},saveConfig:function(t){t.fn.enableLoading(t),t.fn.saveEditorsData(t);var e=m.extend(!0,{},t.config),n=JSON.stringify(e),i=t.fn.getPluginConfig(t),a=JSON.stringify(i);m.ajax({url:t.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:t.wp_ajax_nonce,action:t.wp_ajax_action_update,id:t.wp_item_id,data:n,config:a}}).done(function(e){if(e)return t.wp_item_id=e.data.id,t.fn.showNotice(t,e.data.msg,e.success?"notice-success":"notice-error"),void t.rootScope.scan();t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).fail(function(){t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).always(function(){t.fn.disableLoading(t)})},loadConfigFromJson:function(e,t){if(t){var n=JSON.parse(t);e.config=m.extend(!0,{},n),e.rootScope.scan()}},loadConfigFromFile:function(e){var t=m("#ipages-load-config-from-file").off("change");t.one("change",m.proxy(function(n,e){var t=e.target.files[0];if(e.target.value="",t){var i=new FileReader;i.onload=m.proxy(function(e){var t=e.target.result;n.fn.loadConfigFromJson(n,t)},this),i.readAsText(t)}},this,e)),t.click()},saveConfigToFile:function(e){var t=m.extend(!0,{},e.config),n=JSON.stringify(t),i=e.wp_item_id?"ipages_config_"+e.wp_item_id+".json":"ipages_config.json",a=new File([n],i,{type:"application/json;charset=utf-8"});o(a)},showNotice:function(e,t,n){var i=m("#ipages-messages"),a=m("<div></div>").addClass("notice is-dismissible").addClass(n),o=m("<p></p>").html(t),r=m("<button></button>").attr("type","button").addClass("notice-dismiss").html('<span class="screen-reader-text">Dismiss this notice.</span>');function l(){clearTimeout(a.data("timer")),a.fadeTo(100,0,function(){a.slideUp(100,function(){a.remove()})})}a.data("timer",setTimeout(l,5e3)),r.click(function(e){e.preventDefault(),l()}),a.append(o,r),i.append(a)},createBlob:function(e,t,n){return new Blob([t],{type:n})},createObjectURL:function(e,t,n){var i=e.fn.createBlob(e,t,n);return URL.createObjectURL(i)},onPageImageUpdate:function(r,t,e,l){var c=m(e),n=r.pageStatus.get(t);function i(){if(null!=r.pdf&&0<t.pdfPageNumber){var e=c.data("update-timer-id");clearTimeout(e),e=setTimeout(function(){r.pdf.getPage(t.pdfPageNumber).then(function(e){var t="layer"==l?r.config.pageWidth:160,n=e.getViewport(t/e.getViewport(1).width),i=m("<canvas>"),a=i.get(0).getContext("2d");i.get(0).width=n.width,i.get(0).height=n.height;var o={canvasContext:a,viewport:n};e.render(o).then(function(){i.get(0).toBlob(function(e){var t=r.fn.createObjectURL(r,e,e.type);t="url("+t+")",c.css("background-image",t),c.data("update-timer-id",null),i.remove()})})},function(e){console.error(e.message),r.fn.showNotice(r,e.message,"notice-error"),c.css("background-image","")})},e?1500:1),c.data("update-timer-id",e)}else c.css("background-image","")}function a(){var e=r.fn.getImageUrl(r,t.image,"style");c.css("background-image",e)}n?t.pdfPageNumber!=n.pdfPageNumber||t.dirty!=n.dirty?t.image.url?a():i():t.image.url==n.image.url&&t.image.relative==n.image.relative||a():t.image.url?a():i(),n={pdfPageNumber:t.pdfPageNumber,image:{relative:t.image.relative,url:t.image.url}},r.pageStatus.set(t,n)},getImageUrl:function(e,t,n){var i="";return t&&t.url&&0<t.url.length&&(i=t.relative?e.wp_upload_url+t.url:t.url,"style"==n&&(i="url("+i+")")),i},selectPageImage:function(n){null!=n.ui.activePage&&(n.wpFileFramePageImage||(n.wpFileFramePageImage=wp.media.frames.file_frame=wp.media({library:{type:["image"]},multiple:!1}),n.wpFileFramePageImage.on("select",function(e){var t=n.wpFileFramePageImage.state().get("selection").first().toJSON().url;-1!==t.indexOf(n.wp_upload_url)?(t=t.replace(n.wp_upload_url,""),n.ui.activePage.image.relative=!0):n.ui.activePage.image.relative=!1,n.ui.activePage.image.url=t,n.rootScope.scan()})),n.wpFileFramePageImage.open())},selectBackgroundImage:function(n){n.wpFileFrameBackgroundImage||(n.wpFileFrameBackgroundImage=wp.media.frames.file_frame=wp.media({library:{type:["image"]},multiple:!1}),n.wpFileFrameBackgroundImage.on("select",function(e){var t=n.wpFileFrameBackgroundImage.state().get("selection").first().toJSON().url;-1!==t.indexOf(n.wp_upload_url)?(t=t.replace(n.wp_upload_url,""),n.config.backgroundImage.relative=!0):n.config.backgroundImage.relative=!1,n.config.backgroundImage.url=t,n.rootScope.scan()})),n.wpFileFrameBackgroundImage.open()},selectLayerBackgroundImage:function(n){n.wpFileFrameLayerBackgroundImage||(n.wpFileFrameLayerBackgroundImage=wp.media.frames.file_frame=wp.media({multiple:!1}),n.wpFileFrameLayerBackgroundImage.on("select",function(e){var t=n.wpFileFrameLayerBackgroundImage.state().get("selection").first().toJSON().url;-1!==t.indexOf(n.wp_upload_url)?(t=t.replace(n.wp_upload_url,""),n.ui.activeLayer.image.backgroundImage.relative=!0):n.ui.activeLayer.image.backgroundImage.relative=!1,n.ui.activeLayer.image.backgroundImage.url=t,n.rootScope.scan()})),n.wpFileFrameLayerBackgroundImage.open()},selectFlipSound:function(n){n.wpFileFrameFlipSound||(n.wpFileFrameFlipSound=wp.media.frames.file_frame=wp.media({library:{type:["audio"]},multiple:!1}),n.wpFileFrameFlipSound.on("select",function(e){var t=n.wpFileFrameFlipSound.state().get("selection").first().toJSON().url;n.config.flipSoundUrl=t,n.rootScope.scan()})),n.wpFileFrameFlipSound.open()},playFlipSound:function(e){if(e.config.flipSoundUrl){if(e.$audio){var t=e.$audio.get(0);try{t.pause(),t.currentTime=0}catch(e){}e.$audio.remove(),e.$audio=null}e.$audio=m("<audio preload></audio>"),e.$audio.append(m("<source>").attr("src",e.config.flipSoundUrl)),e.$audio.get(0).play()}},selectPDFDocument:function(n){n.wpFileFramePDFDocument||(n.wpFileFramePDFDocument=wp.media.frames.file_frame=wp.media({library:{type:["application/pdf"]},multiple:!1}),n.wpFileFramePDFDocument.on("select",function(e){var t=n.wpFileFramePDFDocument.state().get("selection").first().toJSON().url;n.config.pdfUrl=t,n.rootScope.scan()})),n.wpFileFramePDFDocument.open()},generatePDFPages:function(e){if(null!=e.pdf){for(var t=0;t<e.pdf.numPages;t++){var n=m.extend(!0,{},e.defaultPage);n.pdfPageNumber=t+1,e.config.pages.push(n)}e.fn.onTab(e,"pages")}},addPage:function(e){var t=m.extend(!0,{},e.defaultPage);e.config.pages.push(t)},addPageWithImage:function(a){a.wpFileFramePageImages||(a.wpFileFramePageImages=wp.media.frames.file_frame=wp.media({library:{type:["image"]},multiple:!0}),a.wpFileFramePageImages.on("select",function(e){a.wpFileFramePageImages.state().get("selection").forEach(function(e,t){var n=e.toJSON().url,i=m.extend(!0,{},a.defaultPage);-1!==n.indexOf(a.wp_upload_url)?(n=n.replace(a.wp_upload_url,""),i.image.relative=!0):i.image.relative=!1,i.image.url=n,a.config.pages.push(i)}),a.rootScope.scan()})),a.wpFileFramePageImages.open()},selectAllPages:function(e){if(0<e.ui.selectedPages.length&&e.ui.selectedPages.length==e.config.pages.length)e.ui.selectedPages=[];else{e.ui.selectedPages=[];for(var t=0;t<e.config.pages.length;t++){var n=e.config.pages[t];e.ui.selectedPages.push(n)}}},isAllPagesSelected:function(e){return 0<e.ui.selectedPages.length&&e.ui.selectedPages.length==e.config.pages.length},isPageActive:function(e,t){return Object.is(e.ui.activePage,t)},isPageSelected:function(e,t){for(var n=0;n<e.ui.selectedPages.length;n++)if(Object.is(e.ui.selectedPages[n],t))return!0;return!1},selectPage:function(e,t){Object.is(e.ui.activePage,t)?e.ui.activePage=null:e.ui.activePage=t},pickPage:function(e,t){var n,i=!0;for(n=0;n<e.ui.selectedPages.length;n++)if(Object.is(e.ui.selectedPages[n],t)){i=!1;break}i?e.ui.selectedPages.push(t):e.ui.selectedPages.splice(n,1)},editPage:function(e,t){Object.is(e.ui.editPage,t)?(e.ui.editPage=null,e.ui.mapLayers&&e.ui.mapLayers.clear(),e.ui.mapLayers=null):(e.ui.activePage=e.ui.editPage=t,e.ui.mapLayers=new Map,e.rootScope.scan(),e.fn.onPageTab(e,"layers"),e.fn.updateEditPageLayout(e))},updateEditPageLayout:function(e){var t=m("#ipages-layer-canvas");if(0!=t.length){var n=m("#ipages-layer-page"),i=t.width()-30,a=t.height()-30,o=e.config.pageWidth,r=e.config.pageHeight,l=1;if(i<=o&&a<=r){var c=i/o,s=a/r;l=s<c?s:c}else i<=o?l=i/o:a<=r&&(l=a/r);e.ui.editPageZoom=l,n.css({"margin-top":-r/2+"px","margin-left":-o/2+"px",width:o+"px",height:r+"px",transform:"scale("+l+")"})}},deletePages:function(e){for(var t=0;t<e.ui.selectedPages.length;t++){var n=e.ui.selectedPages[t];Object.is(e.ui.activePage,n)&&(e.ui.activePage=null);for(var i=0;i<e.config.pages.length;i++)if(Object.is(e.config.pages[i],n)){e.config.pages.splice(i,1);break}}e.ui.selectedPages=[]},onPageDrag:function(e,t){e.fn.isPageSelected(e,t)||(e.fn.pickPage(e,t),e.rootScope.scan())},onPageDrop:function(e,t,n){for(var i=null,a=0;a<e.config.pages.length;a++)if(Object.is(e.config.pages[a],t)){i=a;break}if(null!=i){n||i++,n=[];var o=[],r=[];for(a=0;a<e.config.pages.length;a++){t=e.config.pages[a];for(var l=!1,c=0;c<e.ui.selectedPages.length;c++)if(Object.is(e.ui.selectedPages[c],t)){o.push(t),l=!0;break}l||(a<i?n.push(t):r.push(t))}e.config.pages=n.concat(o.concat(r)),e.rootScope.scan()}},getPageDragElement:function(e){return m("<div></div>").addClass("ipages-drag-element").text("Move "+e.ui.selectedPages.length)},saveEditorsData:function(e){var t=m("#ipages-notepad-css");if(t.length){var n=ace.edit(t.get(0));e.config.customCSS.data=n.getSession().getValue()}var i=m("#ipages-notepad-js");if(i.length){var a=ace.edit(i.get(0));e.config.customJS.data=a.getSession().getValue()}},onTab:function(e,t){if(!e.ui.tabs[t]){var n=e.ui.tabs;for(var i in n)n.hasOwnProperty(i)&&(n[i]=!1);switch(e.ui.tabs[t]=!0,e.fn.saveEditorsData(e),e.rootScope.scan(),t){case"pages":e.fn.updateEditPageLayout(e);break;case"customCSS":var a=m("#ipages-notepad-css"),o=ace.edit(a.get(0));o.$blockScrolling=1/0,o.setTheme("ace/theme/monokai"),o.session.setMode("ace/mode/css"),e.settings.themeCSS&&o.setTheme("ace/theme/"+e.settings.themeCSS),e.config.customCSS.data&&o.getSession().setValue(e.config.customCSS.data);break;case"customJS":var r=m("#ipages-notepad-js"),l=ace.edit(r.get(0));l.$blockScrolling=1/0,l.setTheme("ace/theme/monokai"),l.session.setMode("ace/mode/javascript"),e.settings.themeJavaScript&&l.setTheme("ace/theme/"+e.settings.themeJavaScript),e.config.customJS.data&&l.getSession().setValue(e.config.customJS.data)}}},onPageTab:function(e,t){if(!e.ui.pageTabs[t]){var n=e.ui.pageTabs;for(var i in n)n.hasOwnProperty(i)&&(n[i]=!1);e.ui.pageTabs[t]=!0}},onGeneralTab:function(e,t){e.ui.generalTab[t]=!e.ui.generalTab[t]},onLayerTab:function(e,t){e.ui.layerTab[t]=!e.ui.layerTab[t]},onResize:function(e,t){e.fn.updateEditPageLayout(e)},onFullScreenChange:function(e,t){document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?(m("#ipages-app-item").addClass("ipages-fullscreen"),e.ui.fullscreen=!0):(m("#ipages-app-item").removeClass("ipages-fullscreen"),e.ui.fullscreen=!1),e.rootScope.scan()},toggleFullscreen:function(e){if(e.ui.fullscreen)try{document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch(e){console.error("The browser does not support the fullscreen API")}else try{var t=m("#ipages-app-item").get(0);t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}catch(e){console.error("The browser does not support the fullscreen API")}},initLayer:function(e,t,n){e.ui.mapLayers.set(t,m(n))},initLayerInner:function(e,t,n){"text"==t.type&&t.text.data&&m(n).html(t.text.data)},selectLayer:function(e,t){e.ui.activeLayer=t},isLayerActive:function(e,t){return Object.is(e.ui.activeLayer,t)},onLayerClick:function(e,t){e.fn.isLayerActive(e,t)||e.fn.selectLayer(e,t)},addLayerLink:function(e){if(null!=e.ui.activePage){var t=m.extend(!0,{},e.defaultLayer);t.type="link",e.ui.activePage.layers.push(t),e.fn.selectLayer(e,t)}},addLayerImage:function(e){if(null!=e.ui.activePage){var t=m.extend(!0,{},e.defaultLayer);t.type="image",e.ui.activePage.layers.push(t),e.fn.selectLayer(e,t)}},addLayerText:function(e){if(null!=e.ui.activePage){var t=m.extend(!0,{},e.defaultLayer);t.type="text",t.text.data=e.msg_edit_text,e.ui.activePage.layers.push(t),e.fn.selectLayer(e,t)}},copyLayer:function(e){if(null!=e.ui.activeLayer){for(var t=null,n=e.ui.activePage.layers.length,i=null,a=0;a<n;a++)if(i=e.ui.activePage.layers[a],Object.is(e.ui.activeLayer,i)){t=a;break}null!=t&&((i=m.extend(!0,{},i)).title=(i.title?i.title:i.type)+" [copy]",e.ui.activePage.layers.splice(t+1,0,i),e.fn.selectLayer(e,i))}},updownLayer:function(e,t){if(null!=e.ui.activeLayer){for(var n=null,i=e.ui.activePage.layers.length,a=null,o=0;o<i;o++)if(a=e.ui.activePage.layers[o],Object.is(e.ui.activeLayer,a)){n=o;break}if(null!=n)if("up"==t&&0<n)e.ui.activePage.layers[n]=e.ui.activePage.layers[n-1],e.ui.activePage.layers[n-1]=a,n-=1;else{if(!("down"==t&&n<i-1))return;e.ui.activePage.layers[n]=e.ui.activePage.layers[n+1],e.ui.activePage.layers[n+1]=a,n+=1}}},deleteLayer:function(e){if(null!=e.ui.activeLayer){for(var t=null,n=e.ui.activePage.layers.length,i=0;i<n;i++){var a=e.ui.activePage.layers[i];if(Object.is(e.ui.activeLayer,a)){t=i;break}}if(null!=t){var o=t;0<=t&&t<n&&(e.ui.activePage.layers.splice(t,1),t==n-1&&1<n?o=n-2:1==n&&(o=null)),e.fn.selectLayer(e,e.ui.activePage.layers[o])}}},editLayerAlign:function(e,t){if(null!=e.ui.activeLayer){var n=e.ui.activeLayer;switch(t){case"top":n.y=0;break;case"middle":n.y=e.config.pageHeight/2-n.height/2;break;case"bottom":n.y=e.config.pageHeight-n.height;break;case"left":n.x=0;break;case"center":n.x=e.config.pageWidth/2-n.width/2;break;case"right":n.x=e.config.pageWidth-n.width}}},toggleLayerVisible:function(e,t){t.visible=!t.visible},toggleLayerLock:function(e,t){t.lock=!t.lock},initBookControlIcon:function(e,t,n){t&&m(n).addClass(t.icon)},selectBookControl:function(e,t){e.ui.activeBookControl=t},isBookControlActive:function(e,t){return Object.is(e.ui.activeBookControl,t)},isBookControlEdit:function(e,t){return Object.is(e.ui.editBookControl,t)},toggleBookControlActive:function(e,t){t.active=!t.active},toggleBookControlOptional:function(e,t){t.optional=!t.optional},editBookControlTitle:function(e,t,n){n&&setTimeout(function(){m(n).find(".ipages-text").first().focus()},1),t&&(e.ui.activeBookControl=t),null!=e.ui.activeBookControl&&(e.ui.editBookControl=e.ui.activeBookControl)},updownBookControl:function(e,t){if(null!=e.ui.activeBookControl){for(var n=null,i=e.config.toolbarControls.length,a=null,o=0;o<i;o++)if(a=e.config.toolbarControls[o],Object.is(e.ui.activeBookControl,a)){n=o;break}if(null!=n)if("up"==t&&0<n)e.config.toolbarControls[n]=e.config.toolbarControls[n-1],e.config.toolbarControls[n-1]=a,n-=1;else{if(!("down"==t&&n<i-1))return;e.config.toolbarControls[n]=e.config.toolbarControls[n+1],e.config.toolbarControls[n+1]=a,n+=1}}},onBookControlEnter:function(e,t){13==t.which&&(e.ui.editBookControl=null)},getBookmarkLevel:function(e,t){return 20*t.level+"px"},getBookmarkLabel:function(e,t){var n="";return t.text&&(n+=t.text+" "),t.link&&(n+="["+t.link+"]"),n},selectBookmark:function(e,t){e.ui.activeBookmark=t},isBookmarkActive:function(e,t){return Object.is(e.ui.activeBookmark,t)},isBookmarkEdit:function(e,t){return Object.is(e.ui.editBookmark,t)},toggleBookmarkActive:function(e,t){t.active=!t.active},addBookmark:function(e){var t=m.extend(!0,{},e.defaultBookmark);e.config.bookmarks.push(t),e.fn.selectBookmark(e,t)},copyBookmark:function(e){if(null!=e.ui.activeBookmark){for(var t=null,n=e.config.bookmarks.length,i=null,a=0;a<n;a++)if(i=e.config.bookmarks[a],Object.is(e.ui.activeBookmark,i)){t=a;break}null!=t&&((i=m.extend(!0,{},i)).text=i.text+"[copy]",e.config.bookmarks.splice(t+1,0,i),e.fn.selectBookmark(e,i))}},editBookmark:function(e,t,n){n&&setTimeout(function(){m(n).find(".ipages-text").first().focus()},1),t&&(e.ui.activeBookmark=t),null!=e.ui.activeBookmark&&(e.ui.editBookmark=e.ui.activeBookmark)},deleteBookmark:function(e){if(null!=e.ui.activeBookmark){for(var t=null,n=e.config.bookmarks.length,i=0;i<n;i++){var a=e.config.bookmarks[i];if(Object.is(e.ui.activeBookmark,a)){t=i;break}}if(null!=t){var o=t;0<=t&&t<n&&(e.config.bookmarks.splice(t,1),t==n-1&&1<n?o=n-2:1==n&&(o=null)),e.fn.selectBookmark(e,e.config.bookmarks[o])}}},onBookmarkEnter:function(e,t){13==t.which&&(e.ui.editBookmark=null)},updownBookmark:function(e,t){if(null!=e.ui.activeBookmark){for(var n=null,i=e.config.bookmarks.length,a=null,o=0;o<i;o++)if(a=e.config.bookmarks[o],Object.is(e.ui.activeBookmark,a)){n=o;break}if(null!=n)if("up"==t&&0<n)e.config.bookmarks[n]=e.config.bookmarks[n-1],e.config.bookmarks[n-1]=a,n-=1;else{if(!("down"==t&&n<i-1))return;e.config.bookmarks[n]=e.config.bookmarks[n+1],e.config.bookmarks[n+1]=a,n+=1}}},levelBookmark:function(e,t){null!=e.ui.activeBookmark&&("left"==t?e.ui.activeBookmark.level-=1:"right"==t&&(e.ui.activeBookmark.level+=1),e.ui.activeBookmark.level<0&&(e.ui.activeBookmark.level=0),3<e.ui.activeBookmark.level&&(e.ui.activeBookmark.level=3))},getLayerStyle:function(e,t,n){switch(n){case"x":return t.x+"px";case"y":return t.y+"px";case"width":return t.width+"px";case"height":return t.height+"px";case"angle":return t.angle?"rotate("+t.angle+"deg)":"rotate(0deg)";case"border-radius":return"link"==t.type?t.link.radius?t.link.radius:"":null;case"background-color":return"link"==t.type?t.link.normalColor?t.link.normalColor:"":null;case"background-image":return"image"==t.type?e.fn.getImageUrl(e,t.image.backgroundImage,"style"):null;case"background-size":return"image"==t.type?t.image.backgroundSize?t.image.backgroundSize:"":null;case"background-repeat":return"image"==t.type?t.image.backgroundRepeat?t.image.backgroundRepeat:"":null;case"background-position":return"image"==t.type?t.image.backgroundPosition?t.image.backgroundPosition:"":null;case"color":return"text"==t.type?t.text.color:null;case"font-size":return"text"==t.type?(0<t.text.size?t.text.size:0)+"px":null;case"line-height":return"text"==t.type?(0<t.text.lineHeight?t.text.lineHeight:0)+"px":null;case"letter-spacing":return"text"==t.type?(0<t.text.letterSpacing?t.text.letterSpacing:0)+"px":null;case"text-align":if("text"==t.type)return t.text.align?t.text.align:""}return null},onEditLayerKeyDown:function(e,t,n){var i=e.ui.mapLayers.get(t);if(!t.lock&&!i.hasClass("ipages-editing")){var a=!1;switch(n.which){case 37:t.x-=1,a=!0;break;case 38:t.y-=1,a=!0;break;case 39:t.x+=1,a=!0;break;case 40:t.y+=1,a=!0}a&&(n.preventDefault(),n.stopPropagation(),e.rootScope.scan())}},onEditLabelText:function(t,n,e,i){if(!n.lock&&"text"==n.type){var a=t.ui.mapLayers.get(n),o=m(e);a.addClass("ipages-editing"),o.attr("contenteditable",!0).focus(),o.on("input",r),o.one("blur",function(e){a.removeClass("ipages-editing"),o.attr("contenteditable",!1),o.off("input",r)})}function r(e){n.text.data=o.html(),""==n.text.data.replace("<br>","").trim()&&(n.text.data=t.msg_edit_text,o.html(n.text.data))}},onEditLayerStart:function(e,t,n,i){var a=e.ui.mapLayers.get(t);t.lock||a.hasClass("ipages-editing")||(e.fn.onLayerClick(e,t),e.ui.editLayer.type=n,e.ui.editLayer.initX=i.pageX,e.ui.editLayer.initY=i.pageY,e.ui.editLayer.lastX=i.pageX,e.ui.editLayer.lastY=i.pageY,e.ui.editLayer.centerX=a.offset().left+a.width()/2,e.ui.editLayer.centerY=a.offset().top+a.height()/2,e.ui.editLayer.rotation=Math.atan2(i.pageY-e.ui.editLayer.centerY,i.pageX-e.ui.editLayer.centerX),e.ui.editLayer.layerAngle=t.angle,e.ui.editLayer.layerX=t.x,e.ui.editLayer.layerY=t.y,e.ui.editLayer.layerWidth=t.width,e.ui.editLayer.layerHeight=t.height,"drag"!=n&&(i.preventDefault(),i.stopPropagation()),m("body").on("mousemove",m.proxy(e.fn.onEditLayerMove,this,e,t)),m("body").on("mouseup",m.proxy(e.fn.onEditLayerEnd,this,e,t)),m("body").on("mouseleave",m.proxy(e.fn.onEditLayerEnd,this,e,t)))},onEditLayerMove:function(i,a,o){o.preventDefault(),o.stopPropagation();var e,t,n,r=i.ui.editPageZoom;function l(){var e=o.pageX-i.ui.editLayer.initX,t=i.ui.editLayer.layerX+e/r,n=i.ui.editLayer.layerWidth-e;n<=0?a.width=0:(a.width=n,a.x=t),i.rootScope.scan()}function c(){var e=o.pageY-i.ui.editLayer.initY,t=i.ui.editLayer.layerY+e/r,n=i.ui.editLayer.layerHeight-e;n<=0?a.height=0:(a.height=n,a.y=t),i.rootScope.scan()}function s(){var e=o.pageX-i.ui.editLayer.initX,t=i.ui.editLayer.layerWidth+e;a.width=t<=0?0:t,i.rootScope.scan()}function u(){var e=o.pageY-i.ui.editLayer.initY,t=i.ui.editLayer.layerHeight+e;a.height=t<=0?0:t,i.rootScope.scan()}switch(i.ui.editLayer.type){case"drag":t=o.pageX-i.ui.editLayer.lastX,n=o.pageY-i.ui.editLayer.lastY,i.ui.editLayer.lastX=o.pageX,i.ui.editLayer.lastY=o.pageY,a.x=a.x+t/r,a.y=a.y+n/r,i.rootScope.scan();break;case"rotate":e=(Math.atan2(o.pageY-i.ui.editLayer.centerY,o.pageX-i.ui.editLayer.centerX)-i.ui.editLayer.rotation)*(180/Math.PI),a.angle=i.ui.editLayer.layerAngle+e,a.angle<0?a.angle=360+a.angle:360<=a.angle&&(a.angle=a.angle-360),i.rootScope.scan();break;case"tl":c(),l();break;case"tm":c();break;case"tr":c(),s();break;case"rm":s();break;case"br":u(),s();break;case"bm":u();break;case"bl":u(),l();break;case"lm":l()}},onEditLayerEnd:function(e,t,n){n.preventDefault(),n.stopPropagation(),m("body").off("mousemove",m.proxy(e.fn.onEditLayerMove,this,e,t)),m("body").off("mouseup",m.proxy(e.fn.onEditLayerEnd,this,e,t)),m("body").off("mouseleave",m.proxy(e.fn.onEditLayerEnd,this,e,t)),e.ui.editLayer.type=null,e.ui.editLayer.initX=null,e.ui.editLayer.initY=null,e.ui.editLayer.lastX=null,e.ui.editLayer.lastY=null,e.ui.editLayer.centerX=null,e.ui.editLayer.centerY=null,e.ui.editLayer.rotation=0,e.ui.editLayer.layerAngle=null,e.ui.editLayer.layerX=null,e.ui.editLayer.layerY=null,e.ui.editLayer.layerWidth=null,e.ui.editLayer.layerHeight=null},floor:function(e,t){return Math.floor(t)}}},window.alightInitCallback=function(e){delete window.alightInitCallback,e.directives.al.text={restrict:"EA",link:function(i,e,a,o){var r=m(e),l=m(e);l.on("input change",function(e){var t,n=l.val();(!(t=n)||/^\s*$/.test(t))&&(n=null),o.setValue(a,n),o.scan(),function(){var e=r.data("callback");if(e){var t=o.changeDetector.compile(e);t(i)}}()}),o.watch(a,function(e){null==e?l.val(null):l.val(e)},{readOnly:!0})}},e.directives.al.integer={restrict:"EA",link:function(a,e,o,r){var l=m(e),c=m(e);c.on("input change",function(e){var t,n=c.val(),i=!0;!(t=n)||/^\s*$/.test(t)?n=null:n.match("^([+-]?[1-9]+[0-9]*|0)$")?n=parseInt(n,10):i=!1,i?(r.setValue(o,n),r.scan(),function(){var e=l.data("callback");if(e){var t=r.changeDetector.compile(e);t(a)}}(),l.removeClass("ipages-invalid")):l.addClass("ipages-invalid")}),r.watch(o,function(e){l.removeClass("ipages-invalid"),null==e?c.val(null):c.val(e)},{readOnly:!0})}},e.directives.al.float={restrict:"EA",link:function(a,e,o,r){var l=m(e),c=m(e);c.on("input change",function(e){var t,n=c.val(),i=!0;!(t=n)||/^\s*$/.test(t)?n=null:n.match("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$")?n=parseFloat(n):i=!1,i?(r.setValue(o,n),r.scan(),function(){var e=l.data("callback");if(e){var t=r.changeDetector.compile(e);t(a)}}(),l.removeClass("ipages-invalid")):l.addClass("ipages-invalid")}),r.watch(o,function(e){l.removeClass("ipages-invalid"),null==e?c.val(null):c.val(e)},{readOnly:!0})}},e.directives.al.toggle={restrict:"EA",link:function(n,e,t,i){var a=m(e);a.addClass("ipages-toggle").html("&nbsp;"),a.on("mousedown touchstart",function(e){i.setValue(t,!i.getValue(t)),i.scan(),function(){var e=a.data("callback");if(e){var t=i.changeDetector.compile(e);t(n)}}()}),i.watch(t,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},e.directives.al.checkbox={restrict:"EA",link:function(n,e,t,i){var a=m(e);a.addClass("ipages-checkbox").html('<i class="ipages-icon ipages-icon-check"></i>'),a.on("mousedown touchstart",function(e){i.setValue(t,!i.getValue(t)),i.scan(),function(){var e=a.data("callback");if(e){var t=i.changeDetector.compile(e);t(n)}}()}),i.watch(t,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},e.directives.al.dragdrop={restrict:"EA",link:function(a,e,o,r){var t=m(e);t.attr("draggable",!0);var l=m("<div></div>").addClass("ipages-drag-before"),n=m("<div></div>").addClass("ipages-drag-after");t.append(l,n);var i=r.takeAttr("on-drag"),c=r.takeAttr("on-drop"),s=r.takeAttr("get-drag-element"),u=null,p=new Image;function f(){t.removeClass("ipages-drag-over"),l.removeClass("ipages-drag-over"),n.removeClass("ipages-drag-over"),m(window).off("dragover",d),u&&u.remove()}function d(e){var t=window.innerHeight||m(window).height();e.clientY<30?m(window).scrollTop(m(window).scrollTop()-10):e.clientY>t-30&&m(window).scrollTop(m(window).scrollTop()+10),u&&u.css({top:e.clientY-u.outerHeight()/2,left:e.clientX-u.outerWidth()-20})}function g(e){e.preventDefault(),m(this).addClass("ipages-drag-over")}function h(e){m(this).removeClass("ipages-drag-over")}p.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.on("dragstart",function(e){if(i){var t=r.changeDetector.compile(i,{input:["item"]}),n=r.getValue(o);t(a,n)}e.originalEvent.dataTransfer.setData("Text","fix for firefox"),s&&(e.originalEvent.dataTransfer.setDragImage(p,0,0),u=r.getValue(s),m("body").append(u),m(window).on("dragover",d))}),l.on("dragover",g),n.on("dragover",g),l.on("dragleave",h),n.on("dragleave",h),t.on("drop",function(e){var t=l.hasClass("ipages-drag-over");if(f(),c){var n=r.changeDetector.compile(c,{input:["item","before"]}),i=r.getValue(o);n(a,i,t)}}),t.on("dragend",function(e){f()})}},e.directives.al.pageImage={restrict:"EA",link:function(t,n,e,i){var a=i.takeAttr("on-page-image-update"),o=i.changeDetector.compile(a,{input:["page","$element"]}),r=i.getValue(e);i.watch(e,function(e){o(t,r,n)},{readOnly:!0,deep:3})}},e.directives.al.style={restrict:"EA",link:function(e,t,n,i){if(i.attrArgument){var a=m(t),o=i.attrArgument.split(".")[0];i.watch(n,function(e){a.css(o,e)},{readOnly:!0})}}},e.directives.al.backgroundrepeat={restrict:"EA",link:function(e,t,n,i){var a=m(t),o=m("<select/>").addClass(a.get(0).className);o.append('<option value="none">none</option>'),o.append('<option value="repeat">repeat</option>'),o.append('<option value="repeat-x">repeat-x</option>'),o.append('<option value="repeat-y">repeat-y</option>'),o.append('<option value="no-repeat">no-repeat</option>'),a.append(o),o.unwrap(),o.on("change",function(e){var t=o.val();"none"==t&&(t=null),i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?o.val("none"):o.val(e)},{readOnly:!0})}},e.directives.al.backgroundsize={restrict:"EA",link:function(e,t,n,i){var a=m(t),o=m("<select/>").addClass(a.get(0).className);o.append('<option value="none">none</option>'),o.append('<option value="auto">auto</option>'),o.append('<option value="cover">cover</option>'),o.append('<option value="contain">contain</option>'),o.append('<option value="100% 100%">stretch</option>'),a.append(o),o.unwrap(),o.on("change",function(e){var t=o.val();"none"==t&&(t=null),i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?o.val("none"):o.val(e)},{readOnly:!0})}},e.directives.al.textalign={restrict:"EA",link:function(e,t,n,i){var a=m(t),o=m("<select/>").addClass(a.get(0).className);o.append('<option value="none">none</option>'),o.append('<option value="left">left</option>'),o.append('<option value="right">right</option>'),o.append('<option value="center">center</option>'),o.append('<option value="justify">justify</option>'),a.append(o),o.unwrap(),o.on("change",function(e){var t=o.val();"none"==t&&(t=null),i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?o.val("none"):o.val(e)},{readOnly:!0})}},n.alight=e,n.rootScope=n.alight(document.querySelectorAll("#ipages-app-item")[0],{appData:n}),n.fn.init(n)}):m("#ipages-app-settings").length&&(t={alight:null,rootScope:null,wp_ajax_url:null,wp_ajax_nonce:null,wp_ajax_action_update:null,wp_ajax_action_get:null,wp_ajax_action_delete_data:null,wp_ajax_msg_error:null,themes:null,config:{themeJavaScript:null,themeCSS:null,pdfProgressiveLoading:!0},ui:{tabs:{general:!0,actions:!1}},fn:{init:function(e){m("#ipages-app-settings").removeAttr("style"),e.plan=ipages_flipbook.plan,e.wp_ajax_url=ipages_flipbook.ajax_url,e.wp_ajax_nonce=ipages_flipbook.ajax_nonce,e.wp_ajax_action_update=ipages_flipbook.ajax_action_update,e.wp_ajax_action_get=ipages_flipbook.ajax_action_get,e.wp_ajax_action_delete_data=ipages_flipbook.ajax_action_delete_data,e.wp_ajax_msg_error=ipages_flipbook.ajax_msg_error,e.fn.initConfig(e)},enableLoading:function(e){m("#ipages-app-settings").removeClass("ipages-active")},disableLoading:function(e){setTimeout(function(){m("#ipages-app-settings").addClass("ipages-active")},1e3)},loadThemes:function(i){var a=m.Deferred();return m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_get,type:"editor-themes"},success:function(e){e&&e.success?a.resolve(e.data.list):this.error()},error:function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error"),a.resolve(null)}}),a.promise()},initConfig:function(n){n.fn.enableLoading(n),n.fn.loadThemes(n).done(function(e){n.themes=e}).always(function(){if(ipages_flipbook.config){var e=m.extend(!0,{},JSON.parse(ipages_flipbook.config));if(e)for(var t in e)n.config.hasOwnProperty(t)&&(n.config[t]=e[t])}n.rootScope.scan(),n.fn.disableLoading(n)})},saveConfig:function(t){t.fn.enableLoading(t);var e=m.extend(!0,{},t.config);e=JSON.stringify(e),m.ajax({url:t.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:t.wp_ajax_nonce,action:t.wp_ajax_action_update,config:e}}).done(function(e){e?t.fn.showNotice(t,e.data.msg,e.success?"notice-success":"notice-error"):t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).fail(function(){t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).always(function(){t.fn.disableLoading(t)})},deleteAllData:function(t,e){confirm(e)&&(t.fn.enableLoading(t),m.ajax({url:t.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:t.wp_ajax_nonce,action:t.wp_ajax_action_delete_data}}).done(function(e){e?t.fn.showNotice(t,e.data.msg,e.success?"notice-success":"notice-error"):t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).fail(function(){t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).always(function(){t.fn.disableLoading(t)}))},showNotice:function(e,t,n){var i=m("#ipages-messages"),a=m("<div></div>").addClass("notice is-dismissible").addClass(n),o=m("<p></p>").html(t),r=m("<button></button>").attr("type","button").addClass("notice-dismiss").html('<span class="screen-reader-text">Dismiss this notice.</span>');function l(){clearTimeout(a.data("timer")),a.fadeTo(100,0,function(){a.slideUp(100,function(){a.remove()})})}a.data("timer",setTimeout(l,5e3)),r.click(function(e){e.preventDefault(),l()}),a.append(o,r),i.append(a)},onTab:function(e,t){if(!e.ui.tabs[t]){var n=e.ui.tabs;for(var i in n)n.hasOwnProperty(i)&&(n[i]=!1);e.ui.tabs[t]=!0}}}},window.alightInitCallback=function(e){delete window.alightInitCallback,e.directives.al.toggle={restrict:"EA",link:function(n,e,t,i){var a=m(e);a.addClass("ipages-toggle").html("&nbsp;"),a.on("mousedown touchstart",function(e){i.setValue(t,!i.getValue(t)),i.scan(),function(){var e=a.data("callback");if(e){var t=i.changeDetector.compile(e);t(n)}}()}),i.watch(t,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},t.alight=e,t.rootScope=t.alight(document.querySelectorAll("#ipages-app-settings")[0],{appData:t}),t.fn.init(t)}),function(){function e(){var K=function(e,t){return K.bootstrap(e,t)};K.version="0.14.0",K.filters={},K.text={},K.core={},K.utils={},K.option={globalController:!1,removeAttribute:!0,domOptimization:!0,domOptimizationRemoveEmpty:!0,fastBinding:!0},K.debug={scan:0,directive:!1,watch:!1,watchText:!1,parser:!1},K.ctrl=K.controllers={},K.d=K.directives={al:{},bo:{},$global:{}},K.hooks={directive:[],binding:[]},K.priority={al:{app:2e3,checked:20,class:30,css:30,focused:20,if:700,ifnot:700,model:25,radio:25,repeat:1e3,select:20,stop:-10,value:20,on:10},$component:5,$attribute:-5};var e,t,n,i,a,u,b,o,r,k,P,s,d,w,p,l,x,c,_,A,F,f,g,N,h,$,j,m,v,y,C,D,S,L,B,T,E,O,I,M,z,H,V,R,W,U,J,Y,X,q,Z,G,Q,ee,te,ne,ie,ae,oe,re,le,ce,se,ue=K.f$={},pe=function(e,t){var n=e.indexOf(t);0<=n?e.splice(n,1):console.warn("trying to remove not exist item")};function fe(t,e){var n,i=[],a=!1,o=e.cd,r=e.callback;if(e.filterConf.args.length){var l=[];e.filterConf.args.forEach(function(e,t){var n=o.watch(e,function(e){i[t+1]=e,s()});n.$.isStatic||l.push(n)});var c=!1,s=function(){c||(c=!0,o.watch("$onScanOnce",function(){if(c=!1,a){var e=t.apply(null,i);ue.isPromise(e)?e.then(function(e){r(e),o.scan()}):r(e)}}))};l.length&&(n=function(){l.forEach(function(e){return e.stop()})})}else s=function(){var e=t(i[0]);ue.isPromise(e)?e.then(function(e){r(e),o.scan()}):r(e)};return{onChange:function(e){a=!0,i[0]=e,s()},onStop:n,watchMode:e.watchMode}}function de(e,t,n,i){i.setValue(i.attrArgument,t)}return ue.before=function(e,t){e.parentNode.insertBefore(t,e)},ue.after=function(e,t){var n=e.parentNode,i=e.nextSibling;i?n.insertBefore(t,i):n.appendChild(t)},ue.remove=function(e){var t=e.parentNode;t&&t.removeChild(e)},ue.on=function(e,t,n){e.addEventListener(t,n,!1)},ue.off=function(e,t,n){e.removeEventListener(t,n,!1)},ue.isFunction=function(e){return e&&"[object Function]"===Object.prototype.toString.call(e)},ue.isObject=function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},ue.isPromise=function(e){return e&&window.Promise&&e instanceof window.Promise},ue.isElement=function(e){return e instanceof HTMLElement},ue.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},ue.removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^| )"+t.split(" ").join("|")+"( |$)","gi")," ")},ue.rawAjax=function(e){var t=new XMLHttpRequest;for(var n in t.open(e.type||"GET",e.url,!0,e.username,e.password),e.headers)t.setRequestHeader(n,e.headers[n]);e.success&&(t.onload=function(){200<=t.status&&t.status<400?e.success(t.responseText):e.error&&e.error()}),e.error&&(t.onerror=e.error),t.send(e.data||null)},ue.ajaxCache={},ue.ajax=function(e){if(e.username||e.password||e.headers||e.data||!e.cache)return ue.rawAjax(e);var t=e.type||"GET",n=t+":"+e.url,i=ue.ajaxCache[n];i||(ue.ajaxCache[n]=i={callback:[]}),i.result?e.success&&e.success(i.result):(i.callback.push(e),i.loading||(i.loading=!0,ue.rawAjax({type:t,url:e.url,success:function(e){i.loading=!1,i.result=e;for(var t=0;t<i.callback.length;t++)i.callback[t].success&&i.callback[t].success(e);i.callback.length=0},error:function(){i.loading=!1;for(var e=0;e<i.callback.length;e++)i.callback[e].error&&i.callback[e].error();i.callback.length=0}})))},e='@charset "UTF-8";[al-cloak],[hidden],.al-hide{display:none !important;}',t=document.querySelectorAll("head")[0],(n=document.createElement("style")).setAttribute("type","text/css"),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n),ue.ready=(a=!(i=[]),ue.on(document,"DOMContentLoaded",function e(){a=!0,ue.off(document,"DOMContentLoaded",e);for(var t=0;t<i.length;t++)i[t]();i.length=0}),function(e){a?e():i.push(e)}),window.jQuery&&(window.jQuery.fn.alight=function(e){var n=[];if(this.each(function(e,t){return n.push(t)}),n.length)return K(n,e)}),K.core.getFilter=function(e,t){var n=t.locals[e];if(n&&(ue.isFunction(n)||n.init||n.fn))return n;if(n=K.filters[e])return n;throw"Filter not found: "+e},K.core.buildFilterNode=function(e,t,n,i){if(ue.isFunction(n))return fe(n,{cd:e,filterConf:t,callback:i});if(n.init)return n.init.call(e,e.scope,t.raw,{setValue:i,conf:t,changeDetector:e});if(ue.isFunction(n.fn))return fe(n.fn,{cd:e,filterConf:t,callback:i,watchMode:n.watchMode});throw"Wrong filter: "+t.name},K.ChangeDetector=function(e){var t,n;return n=new o,t=new u(n,e||{}),n.topCD=t},(o=function(){return this.watchers={any:[],finishBinding:[],finishScan:[],finishScanOnce:[],onScanOnce:[]},this.status=null,this.extraLoop=!1,this.finishBinding_lock=!1,this.lateScan=!1,this.topCD=null,this}).prototype.destroy=function(){if(this.watchers.any.length=0,this.watchers.finishBinding.length=0,this.watchers.finishScan.length=0,this.watchers.finishScanOnce.length=0,this.watchers.onScanOnce.length=0,this.topCD)return this.topCD.destroy()},(u=function(e,t){this.scope=t,this.locals=t,this.root=e,this.watchList=[],this.destroy_callbacks=[],this.parent=null,this.children=[],this.rwatchers={any:[],finishScan:[],elEvents:[]}}).prototype.new=function(e,t){var n,i,a;return t=t||{},a=this,null==e&&(e=a.scope),(i=new u(a.root,e)).parent=a,e===a.scope&&(t.locals?((n=a._ChildLocals)||(a._ChildLocals=n=function(){return this.$$root=e,this},n.prototype=a.locals),i.locals=new n):i.locals=a.locals),a.children.push(i),i},u.prototype.destroy=function(){var e,t,n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k,w,x;for(w=(e=this).root,e.scope=null,e.parent&&pe(e.parent.children,e),i=0,r=(h=e.destroy_callbacks).length;i<r;i++)(0,h[i])();for(a=0,l=(m=e.children.slice()).length;a<l;a++)m[a].destroy();for(o=e.destroy_callbacks.length=0,c=(v=e.watchList).length;o<c;o++)(t=v[o]).onStop&&t.onStop();for(f=e.watchList.length=0,s=(y=e.rwatchers.any).length;f<s;f++)x=y[f],pe(w.watchers.any,x);for(d=e.rwatchers.any.length=0,u=(b=e.rwatchers.finishScan).length;d<u;d++)x=b[d],pe(w.watchers.finishScan,x);for(g=e.rwatchers.finishScan.length=0,p=(k=this.rwatchers.elEvents).length;g<p;g++)n=k[g],ue.off(n[0],n[1],n[2]);this.rwatchers.elEvents.length=0,w.topCD===e&&(w.topCD=null,w.destroy())},r=function(e){return this.cb=e},l=function(e,t,n){var i,a;return i=e.root,a=new r(n),e.rwatchers[t].push(a),i.watchers[t].push(a),{stop:function(){return pe(e.rwatchers[t],a),pe(i.watchers[t],a)}}},u.prototype.on=function(e,t,n){return ue.on(e,t,n),this.rwatchers.elEvents.push([e,t,n])},d={$any:function(e,t){return l(e,"any",t)},$finishScan:function(e,t){return l(e,"finishScan",t)},$finishScanOnce:function(e,t){e.root.watchers.finishScanOnce.push(t)},$onScanOnce:function(e,t){e.root.watchers.onScanOnce.push(t)},$destroy:function(e,t){e.destroy_callbacks.push(t)},$finishBinding:function(e,t){e.root.watchers.finishBinding.push(t)}},x=function(){},u.prototype.watch=function(n,t,e){var i,a,o,r,l,c,s,u,p,f;if(l=d[n])return l(this,t);if(!0===(e=e||{})&&(e={isArray:!0}),e.init&&console.warn("watch.init is depricated"),(i=this).root,f=i.scope,ue.isFunction(n)?(r=n,u=K.utils.getId(),c=!0):(c=!1,r=null,"::"===(n=n.trim()).slice(0,2)&&(n=n.slice(2),e.oneTime=!0),u=n,u=e.deep?"d#"+u:e.isArray?"a#"+u:"v#"+u),K.debug.watch&&console.log("$watch",n),s=!1,!c)if(e.watchText)r=e.watchText.fn;else{if((a=K.utils.compile.expression(n)).filter)return function(t,e,n,i){var a=null,o=i.oneTime;if(i.isArray?a="array":i.deep&&(a="deep"),!n){var r={el:i.element,ea:i.elementAttr};n=function(e){P(t.scope,r,e)}}for(var l=K.utils.parsFilter(e.filter),c=[],s=l.result.length-1;0<=s;s--){var u=K.core.getFilter(l.result[s].name,t),p=K.core.buildFilterNode(t,l.result[s],u,n);p.watchMode&&(a=p.watchMode),p.onStop&&c.push(p.onStop),n=p.onChange}return i={oneTime:o},"array"===a?i.isArray=!0:"deep"===a&&(i.deep=!0),c.length&&(i.onStop=function(){c.forEach(function(e){return e()}),c.length=0}),t.watch(e.expression,n,i)}(i,a,t,e);s=a.isSimple&&0===a.simpleVariables.length,r=a.fn}return e.deep&&(e.isArray=!1),o={isStatic:s,isArray:Boolean(e.isArray),extraLoop:!e.readOnly,deep:!0===e.deep?10:e.deep,value:x,callback:t,exp:r,src:""+n,onStop:e.onStop||null,el:e.element||null,ea:e.elementAttr||null},s?i.watch("$onScanOnce",function(){return P(f,o,o.exp(f))}):i.watchList.push(o),p={$:o,stop:function(){var t;if(e.onStop)try{e.onStop()}catch(e){t=e,K.exceptionHandler(t,"Error in onStop of watcher: "+n,n)}if(!o.isStatic)return pe(i.watchList,o)},refresh:function(){var e;return(e=o.exp(i.locals))&&o.deep?o.value=K.utils.clone(e,o.deep):e&&o.isArray?o.value=e.slice():o.value=e}},e.oneTime&&(o.callback=function(e){if(void 0!==e)return p.stop(),t(e)}),p},u.prototype.watchGroup=function(e,t){var n,i,a,o,r,l;if(n=this,!t&&ue.isFunction(e)&&(t=e,e=null),l=!1,i=function(){if(!l)return l=!0,n.watch("$onScanOnce",function(){return l=!1,t()})},e)for(a=0,r=e.length;a<r;a++)o=e[a],n.watch(o,i);return i},s=window.performance?function(){return Math.floor(performance.now())}:function(){return(new Date).getTime()},w=function(e,t){var n,i,a,o;if(null===e||null===t)return!0;if((o=typeof e)!==typeof t)return!0;if("object"===o){if(e.length!==t.length)return!0;for(n=i=0,a=e.length;i<a;n=++i)if(e[n]!==t[n])return!0}return!1},P=function(e,t,n){t.el?t.ea?t.el.setAttribute(t.ea,n):t.el.nodeValue=n:t.callback.call(e,n)},k=function(e,t,n,i){var a,o;return a={src:n.src,scope:t.scope,locals:t.locals},n.el&&(a.element=n.el),o=1===i?"$scan, error in callback: ":"$scan, error in expression: ",K.exceptionHandler(e,o+n.src,a)},b=function(){},p=function(e,t){var n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y;if(e.root,l=!1,m=o=0,e){for(g=[],c=0,a=e;a;){for(f=a.locals,m+=a.watchList.length,s=0,p=(h=a.watchList.slice()).length;s<p;s++){u=(y=h[s]).value;try{v=y.exp(f)}catch(e){r=e,v=b}if(u!==v){if(d=!1,y.isArray?(n=Array.isArray(u))===(i=Array.isArray(v))?n?w(u,v)&&(d=!0,y.value=v.slice()):(d=!0,y.value=v):(d=!0,y.value=i?v.slice():v):y.deep?K.utils.equal(u,v,y.deep)||(d=!0,y.value=K.utils.clone(v,y.deep)):(d=!0,y.value=v),d)if(d=!1,v===b)k(r,a,y);else{o++;try{y.el?y.ea?null!=v?y.el.setAttribute(y.ea,v):y.el.removeAttribute(y.ea):y.el.nodeValue=v:(u===x&&(u=void 0),"$scanNoChanges"!==y.callback.call(a.scope,v,u)&&y.extraLoop&&(l=!0))}catch(e){k(r=e,a,y,1)}}1<K.debug.scan&&console.log("changed:",y.src)}}g.push.apply(g,a.children),a=g[c++]}t.total=m,t.changes=o,t.extraLoop=l}},u.prototype.digest=function(){var e,t,n,i,a,o,r,l,c;for(r=this.root,i=10,c=0,K.debug.scan&&(l=s()),o={total:0,changes:0,extraLoop:!1,src:"",scope:null,element:null};i;){if(i--,r.extraLoop=!1,r.watchers.onScanOnce.length)for(a=r.watchers.onScanOnce.slice(),t=r.watchers.onScanOnce.length=0,n=a.length;t<n;t++)a[t].call(r);if(p(this,o),c+=o.changes,!o.extraLoop&&!r.extraLoop&&!r.watchers.onScanOnce.length)break}return K.debug.scan&&(e=s()-l,console.log("$scan: loops: ("+(10-i)+"), last-loop changes: "+o.changes+", watches: "+o.total+" / "+e+"ms")),o.mainLoop=i,o.totalChanges=c,o},u.prototype.scan=function(e){var t,n,i,a,o,r,l,c,s,u,p;if(p=this.root,e=e||{},!K.option.zone||e.zone){if(ue.isFunction(e)&&(e={callback:e}),e.callback&&p.watchers.finishScanOnce.push(e.callback),e.late){if(p.lateScan)return;return p.lateScan=!0,void K.nextTick(function(){if(p.lateScan)return p.topCD.scan()})}if("scaning"!==p.status){if(p.lateScan=!1,p.status="scaning",(u=p.topCD?p.topCD.digest():{}).totalChanges)for(n=0,o=(c=p.watchers.any).length;n<o;n++)(0,c[n])();for(p.status=null,i=0,r=(s=p.watchers.finishScan).length;i<r;i++)(0,s[i])();for(t=p.watchers.finishScanOnce.slice(),a=p.watchers.finishScanOnce.length=0,l=t.length;a<l;a++)t[a].call(p);if(0===u.mainLoop)throw"Infinity loop detected";return u}p.extraLoop=!0}},(K.core.ChangeDetector=u).prototype.compile=function(e,t){return K.utils.compile.expression(e,t).fn},u.prototype.setValue=function(t,n){var i,a,o,r,l,c,s,u,p,f;o=(i=this).compile(t+" = $value",{input:["$value"],no_return:!0});try{return o(i.locals,n)}catch(e){if(a=e,u="can't set variable: "+t,K.debug.parser&&console.warn(u),0<=(""+a).indexOf("TypeError")&&(f=t.match(/^([\w\d\.]+)\.[\w\d]+$/))&&f[1]){for(s=i.locals,r=0,c=(p=f[1].split(".")).length;r<c;r++)void 0===s[l=p[r]]&&(s[l]={}),s=s[l];try{return void o(i.locals,n)}catch(e){}}return K.exceptionHandler(a,u,{name:t,value:n})}},u.prototype.eval=function(e){return this.compile(e)(this.locals)},u.prototype.getValue=function(e){return this.eval(e)},K.text.$base=function(t){var e,n,i,a,o;if(a=t.point,!(n=(o=(e=t.cd).scope).$ns&&o.$ns.text?o.$ns.text[t.name]:K.text[t.name]))throw"No directive alight.text."+t.name;return i={changeDetector:e,setter:function(e){if(t.update)return a.value=null===e?"":""+e,t.update()},setterRaw:function(e){if(t.updateRaw)return a.value=null===e?"":""+e,t.updateRaw()},finally:function(e){if(t.finally)return a.value=null===e?"":""+e,a.type="text",t.finally(),t.update=null,t.finally=null}},n.call(e,i.setter,t.exp,o,i)},c=function(e,t,n){var i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k,w,x,_,C,D,S,L,B,T,E,A;if(n=n||{},a=this,K.debug.watchText&&console.log("$watchText",e),S=K.utils.compile.buildSimpleText(e,null))a.watch(e,t,{watchText:S,element:n.element,elementAttr:n.elementAttr});else{for(l=K.utils.parsText(e),_=!(i=!(E=0)),s=u=c=function(){},h=0,y=l.length;h<y;h++)if("expression"===(r=l[h]).type)if(w=(p=r.list.join("|")).match(/^([^\w\d\s\$"'\(\u0410-\u044F\u0401\u0451]+)/))r.isDir=!0,"#"===(x=w[1])?(g=p.indexOf(" "))<0?(x=p.substring(1),p=""):(x=p.slice(1,g),p=p.slice(g)):p=p.substring(x.length),K.text.$base({name:x,exp:p,cd:a,point:r,update:function(){return s()},updateRaw:function(){return u()},finally:function(){return s(),c()}}),_=!0,"text"!==r.type&&(i=!1);else if((o=K.utils.compile.expression(p,{string:!0})).filter)E++,i=!1,r.watched=!0,function(t){a.watch(p,function(e){return null==e&&(e=""),t.value=e,s()})}(r);else{if(r.fn=o.fn,!o.rawExpression)throw"Error";o.isSimple&&0===o.simpleVariables.length?(r.type="text",r.value=r.fn()):(r.re=o.rawExpression,E++)}if(i){if(!E){for(B="",m=0,b=l.length;m<b;m++)r=l[m],B+=r.value;return void a.watch("$onScanOnce",function(){return P(a.scope,{callback:t,el:n.element,ea:n.elementAttr},B)})}return S=_?K.utils.compile.buildSimpleText(null,l):K.utils.compile.buildSimpleText(e,l),void a.watch(e,t,{watchText:{fn:S.fn},element:n.element,elementAttr:n.elementAttr})}if(A={callback:t,el:n.element,ea:n.elementAttr},l.scope=a.scope,d=K.utils.compile.buildText(e,l),u=function(){return P(a.scope,A,d())},E){for(T=null,D="",s=function(){D=d()},c=function(){var e,t;for(g=!0,e=0,t=l.length;e<t;e++)if("expression"===(r=l[e]).type){g=!1;break}g&&(a.watch("$finishScanOnce",function(){return T.stop()}),n.onStatic&&n.onStatic())},C=function(){return D},v=0,k=l.length;v<k;v++)if("expression"===(r=l[v]).type){if(r.isDir||r.watched)continue;r.watched=!0,function(t,e){a.watch(e,function(e){return null==e&&(e=""),t.value=e,s()})}(r,r.list.join(" | "))}s(),T=a.watch(C,t,{element:n.element,elementAttr:n.elementAttr})}else L=!1,f=function(){return L=!1,u()},(s=function(){if(!L)return L=!0,a.watch("$onScanOnce",f)})()}},u.prototype.watchText=c,_={TR:1,TD:1,LI:1},K.utils.optmizeElement=function(e,t){var n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k;if(1===e.nodeType){for(t=t||!K.option.domOptimizationRemoveEmpty,"PRE"===e.nodeName&&(t=!0),!(o=e.firstChild)||3!==o.nodeType||o.nodeValue.trim()||t||(ue.remove(o),o=e.firstChild),m=!1;o;)g=o.nextSibling,!m||3!==o.nodeType||o.nodeValue.trim()||t?(m=1===o.nodeType&&_[o.nodeName],K.utils.optmizeElement(o,t)):ue.remove(o),o=g;!(o=e.lastChild)||3!==o.nodeType||o.nodeValue.trim()||t||ue.remove(o)}else if(3===e.nodeType){if(b=e.data,f=K.utils.pars_start_tag,(l=b.indexOf(f))<0)return;if(b.slice(l+f.length).indexOf(f)<0)return;for(h="t",y=[n={value:""}],c=0,u=(a=K.utils.parsText(b)).length;c<u;c++)"text"===(i=a[c]).type?n.value+=i.value:(r=i.list.join("|"),k=K.utils.pars_start_tag+r+K.utils.pars_finish_tag,r.match(/^([^\w\d\s\$"'\(\u0410-\u044F\u0401\u0451]+)/)?("t"===h||"d"===h?n.value+=k:(n={value:k},y.push(n)),h="d"):1===i.list.length?("t"===h||"v"===h?n.value+=k:(n={value:k},y.push(n)),h="v"):"t"===h?n.value+=k:(n={value:k},y.push(n)));if(y.length<2)return;for((o=e).data=y[0].value,s=0,p=(v=y.slice(1)).length;s<p;s++)i=v[s],d=document.createTextNode(i.value),ue.after(o,d),o=d}},K.hooks.attribute=m=[],m.push({code:"dataPrefix",fn:function(){"data-"===this.attrName.slice(0,5)&&(this.attrName=this.attrName.slice(5))}}),m.push({code:"colonNameSpace",fn:function(){var e,t;this.directive||this.name||((t=this.attrName.match(/^(\w+)[\-\:](.+)$/))?(this.ns=t[1],e=t[2]):(this.ns="$global",e=this.attrName),(t=e.match(/^([^\.]+)\.(.*)$/))&&(e=t[1],this.attrArgument=t[2]),this.name=e.replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}))}}),m.push({code:"getGlobalDirective",fn:function(){var e;if(!this.directive){if(!(e=K.d[this.ns]))return this.result="noNS",void(this.stop=!0);this.directive=e[this.name],this.directive||("$global"===this.ns?this.result="noNS":this.result="noDirective",this.stop=!0)}}}),m.push({code:"cloneDirective",fn:function(){var e,t,n,i,a,o;if(a=this.directive,i=this.ns,n=this.name,e={},ue.isFunction(a))e.init=a;else{if(!ue.isObject(a))throw"Wrong directive: "+i+"."+n;for(t in a)o=a[t],e[t]=o}if(e.priority=a.priority||K.priority[i]&&K.priority[i][n]||0,e.restrict=a.restrict||"A",e.restrict.indexOf(this.attrType)<0)throw"Directive has wrong binding (attribute/element): "+n;this.directive=e}}),m.push({code:"preprocessor",fn:function(){var r,l,c;c=this.ns,l=this.name,(r=this.directive).$init=function(e,t,n,i){var a,o;if(o={element:t,value:n,cd:e,env:i,ns:c,name:l,doBinding:(a=function(){var e,t,n,i;for(e=t=0,i=(n=o.procLine).length;t<i;e=++t)if(n[e].fn.call(o),o.isDeferred){o.procLine=n.slice(e+1);break}return o.async=!0,null},!1),directive:r,isDeferred:!1,procLine:K.hooks.directive,makeDeferred:function(){return o.isDeferred=!0,o.doBinding=!0,o.retStopBinding=!0,o.async=!1,function(){if(o.isDeferred=!1,o.async)return a()}}},r.stopBinding&&(i.stopBinding=!0),a(),o.retStopBinding)return"stopBinding"}}}),(v=K.hooks.directive).push({code:"init",fn:function(){var e;this.directive.init&&(K.debug.directive&&this.directive.scope&&console.warn(this.ns+"-"+this.name+" uses scope and init together, probably you need use link instead of init"),this.env.changeDetector=this.cd,(e=this.directive.init.call(this.env,this.cd.scope,this.element,this.value,this.env))&&e.start&&e.start())}}),v.push({code:"templateUrl",fn:function(){var t,n;(n=this).directive.templateUrl&&(t=this.makeDeferred(),ue.ajax({cache:!0,url:this.directive.templateUrl,success:function(e){return n.directive.template=e,t()},error:t}))}}),v.push({code:"template",fn:function(){var e;this.directive.template&&(1===this.element.nodeType?this.element.innerHTML=this.directive.template:8===this.element.nodeType&&((e=document.createElement("p")).innerHTML=this.directive.template.trim(),e=e.firstChild,ue.after(this.element,e),this.element=e,this.doBinding=!0))}}),v.push({code:"scope",fn:function(){var e,t;if(this.directive.scope){switch(t=this.cd,this.directive.scope){case!0:e=t.new({$parent:t.scope});break;case"root":e=K.ChangeDetector({$parent:t.scope}),t.watch("$destroy",function(){return e.destroy()});break;default:throw"Wrong scope value: "+this.directive.scope}this.env.parentChangeDetector=t,this.cd=e,this.doBinding=!0,this.retStopBinding=!0}}}),v.push({code:"link",fn:function(){var e;this.directive.link&&(this.env.changeDetector=this.cd,(e=this.directive.link.call(this.env,this.cd.scope,this.element,this.value,this.env))&&e.start&&e.start())}}),v.push({code:"scopeBinding",fn:function(){this.doBinding&&!this.env.stopBinding&&K.bind(this.cd,this.element,{skip_attr:this.env.skippedAttr()})}}),y=function(e,t,n){var i;"A"===t.attr_type?((i=n||{}).priority=K.priority.$attribute,i.is_attr=!0,i.name=e,i.attrName=e,i.element=t.element,t.list.push(i)):"M"===t.attr_type&&t.list.push(n)},j=function(e,t){var n,i,a,o;if(0<=t.skip_attr.indexOf(e))return y(e,t,{skip:!0});for(n={attrName:e,attrType:t.attr_type,element:t.element,cd:t.cd,result:null},i=0,a=(o=K.hooks.attribute).length;i<a&&(o[i].fn.call(n),!n.stop);i++);if("noNS"!==n.result)return"noDirective"===n.result?"E"===t.attr_type?void t.list.push({name:e,priority:-10,attrName:e,noDirective:!0}):void y(e,t,{noDirective:!0}):void t.list.push({name:e,directive:n.directive,priority:n.directive.priority,attrName:e,attrArgument:n.attrArgument});y(e,t)},$=function(e,t){return e.priority===t.priority?0:e.priority>t.priority?-1:1},F=function(e,t,n,i){var a;if(!((a=n).indexOf(K.utils.pars_start_tag)<0))return e.watchText(a,null,{element:t,elementAttr:i}),!0},h=function(e,t,n){var i;if(!((i=t.data).indexOf(K.utils.pars_start_tag)<0))return e.watchText(i,null,{element:t}),i},f=function(t,n,e){var i,a,o,r,l,c,s,u,p,f;if("directive:"===(p=n.nodeValue.trim()).slice(0,10)){if(0<=(s=(p=p.slice(10).trim()).indexOf(" "))?(o=p.slice(0,+(s-1)+1||9e9),f=p.slice(s+1)):(o=p,f=""),i={list:u=[],element:n,attr_type:"M",cd:t,skip_attr:[]},j(o,i),(a=u[0]).noDirective)throw"Comment directive not found: "+o;r=a.directive,c=new A({element:n,attrName:a.attrName,attributes:u}),K.debug.directive&&console.log("bind",a.attrName,f,a);try{r.$init(t,n,f,c)}catch(e){l=e,K.exceptionHandler(l,"Error in directive: "+a.name,{value:f,env:c,cd:t,scope:t.scope,element:n})}return c.skipToElement?{directive:1,skipToElement:c.skipToElement}:{directive:1,skipToElement:null}}},(A=function(e){var t,n;for(t in e)n=e[t],this[t]=n;return this}).prototype.takeAttr=function(e,t){var n,i,a,o;for(1===arguments.length&&(t=!0),i=0,a=(o=this.attributes).length;i<a;i++)if((n=o[i]).attrName===e)return t&&(n.skip=!0),this.element.getAttribute(e)||!0},A.prototype.skippedAttr=function(){var e,t,n,i,a;for(a=[],t=0,n=(i=this.attributes).length;t<n;t++)(e=i[t]).skip&&a.push(e.attrName);return a},A.prototype.scan=function(e){return this.changeDetector.scan(e)},A.prototype.on=function(e,t,n){return this.changeDetector.on(e,t,n)},A.prototype.watch=function(e,t,n){return this.changeDetector.watch(e,t,n)},A.prototype.watchGroup=function(e,t){return this.changeDetector.watchGroup(e,t)},A.prototype.watchText=function(e,t,n){return this.changeDetector.watchText(e,t,n)},A.prototype.getValue=function(e){return this.changeDetector.getValue(e)},A.prototype.setValue=function(e,t){return this.changeDetector.setValue(e,t)},A.prototype.eval=function(e){return this.changeDetector.eval(e)},A.prototype.new=function(e,t){return!0===t?t={locals:!0}:!0===e&&null==t&&(t={locals:!(e=null)}),this.changeDetector.new(e,t)},A.prototype.bind=function(e,t,n){var i,a,o,r,l,c,s;for(this.stopBinding=!0,l=o=0,c=arguments.length;l<c;l++)(i=arguments[l])instanceof u&&(a=i,o+=1),ue.isElement(i)&&(r=i,o+=1);return(s=arguments[o])||(s={skip:this.skippedAttr()}),r||(r=this.element),a||(a=this.changeDetector),K.bind(a,r,s)},g=function(t,a,e){var n,i,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k,w,x,_,C,D,S,L,B,T,E;if(r={directive:0,hook:0,skipToElement:null,fb:h={attr:[],dir:[],children:[]}},L=!1,T=(e=e||{}).skip_attr,!0===e.skip?e.skip_top=!0:T||(T=e.skip||[]),T instanceof Array||(T=[T]),!e.skip_top){for(n={list:w=[],element:a,skip_attr:T,attr_type:"E",cd:t},o=a.nodeName.toLowerCase(),j(o,n),"script"!==o&&"style"!==o||(L=!0),n.attr_type="A",v=0,y=(D=a.attributes).length;v<y;v++)i=D[v],j(i.name,n);if(e.attachDirective)for(o in S=e.attachDirective)S[o],j(o,n);for(x=0,b=(w=w.sort($)).length;x<b;x++)if(!(u=w[x]).skip){if(u.noDirective)throw"Directive not found: "+u.name;if(u.skip=!0,E=e.attachDirective&&e.attachDirective[u.attrName]?e.attachDirective[u.attrName]:a.getAttribute(u.attrName),u.is_attr)F(t,a,E,u.attrName)&&h.attr.push({attrName:u.attrName,value:E});else{p=u.directive,d=new A({element:a,attrName:u.attrName,attrArgument:u.attrArgument||null,attributes:w,stopBinding:!1,elementCanBeRemoved:e.elementCanBeRemoved,fbElement:e.fbElement}),K.debug.directive&&console.log("bind",u.attrName,E,u);try{"stopBinding"===p.$init(t,a,E,d)&&(L=!0)}catch(e){f=e,K.exceptionHandler(f,"Error in directive: "+u.attrName,{value:E,env:d,cd:t,scope:t.scope,element:a})}if(d.fastBinding?(g=ue.isFunction(d.fastBinding)?d.fastBinding:p.init,h.dir.push({fb:g,attrName:u.attrName,value:E,attrArgument:d.attrArgument,fbData:d.fbData})):r.directive++,d.stopBinding){L=!0;break}d.skipToElement&&(r.skipToElement=d.skipToElement)}}}if(!L)for(B=null,m=_=0,k=(c=function(){var e,t,n,i;for(i=[],t=0,e=(n=a.childNodes).length;t<e;t++)l=n[t],i.push(l);return i}()).length;_<k;m=++_)(l=c[m])&&(B?B===l&&(B=null):(e.fbElement&&(s={fbElement:e.fbElement.childNodes[m]}),C=N(t,l,s),r.directive+=C.directive,r.hook+=C.hook,B=C.skipToElement,C.fb&&(C.fb.text||C.fb.attr&&C.fb.attr.length||C.fb.dir&&C.fb.dir.length||C.fb.children&&C.fb.children.length)&&h.children.push({index:m,fb:C.fb})));return r},N=function(e,t,n){var i,a,o,r,l,c,s;if(c={directive:0,hook:0,skipToElement:null,fb:null},K.hooks.binding.length)for(a=0,o=(l=K.hooks.binding).length;a<o;a++)if(i=l[a],c.hook+=1,(r=i.fn(e,t,n))&&r.owner)return c;return 1===t.nodeType?(r=g(e,t,n),c.directive+=r.directive,c.hook+=r.hook,c.skipToElement=r.skipToElement,c.fb=r.fb):3===t.nodeType?(s=h(e,t))&&(c.fb={text:s}):8===t.nodeType&&(r=f(e,t))&&(c.directive+=r.directive,c.skipToElement=r.skipToElement),c},K.nextTick=(S=null,D=[],C=function(){var t,e,n,i,a,o,r;for(S=null,e=D.slice(),a=D.length=0,o=e.length;a<o;a++){t=(i=e[a])[0],r=i[1];try{t.call(r)}catch(e){n=e,K.exceptionHandler(n,"$nextTick, error in function",{fn:t,self:r})}}return null},function(e){if(D.push([e,this]),!S)return S=setTimeout(C,0)}),K.bind=function(e,t,n){var i,a,o,r,l,c;if(!e)throw"No changeDetector";if(!t)throw"No element";if(n=n||{},K.option.domOptimization&&!n.noDomOptimization&&K.utils.optmizeElement(t),(i=!(c=e.root).finishBinding_lock)&&(c.finishBinding_lock=!0,c.bindingResult={directive:0,hook:0}),l=N(e,t,n),c.bindingResult.directive+=l.directive,c.bindingResult.hook+=l.hook,e.digest(),i){for(c.finishBinding_lock=!1,r=c.watchers.finishBinding.slice(),a=c.watchers.finishBinding.length=0,o=r.length;a<o;a++)(0,r[a])();l.total=c.bindingResult}return l},function(){function l(e,t,n,i,a,o){i.callback.apply(null,o);var r=t._properties.root;r&&r.topCD&&r.topCD.scan({zone:!0})}var c=K.bind;K.bind=function(e,t,n){var i=e.root,a=K.option.zone;if(a){var o=!0===a?Zone:a,r=i.zone;if(r||(i.zone=r=o.current.fork({name:o.current.name+".x",properties:{root:i},onInvokeTask:l})),o.current!==r)return i.zone.run(c,null,[e,t,n])}return c(e,t,n)}}(),K.bootstrap=function(e,t){if(!e)return K.bootstrap("[al-app]"),K.bootstrap("[al\\:app]"),void K.bootstrap("[data-al-app]");var n;if(e instanceof K.core.ChangeDetector)n=e,e=t;else if(t instanceof K.core.ChangeDetector)n=t;else if(ue.isFunction(t)){var i={};n=K.ChangeDetector(i),t.call(n,i)}else t&&(n=K.ChangeDetector(t));if(Array.isArray(e)){for(var a=void 0,o=0,r=e;o<r.length;o++){var l=r[o];a=K.bootstrap(l,n)}return a}if("string"==typeof e){a=void 0;for(var c=0,s=document.querySelectorAll(e);c<s.length;c++){var u=s[c];a=K.bootstrap(u,n)}return a}if(n||(n=K.ChangeDetector()),ue.isElement(e)){for(var p,f,d,g=0,h=["al-app","al:app","data-al-app"];g<h.length&&(p=h[g],f=e.getAttribute(p),e.removeAttribute(p),!f);g++);return f&&(d={skip_attr:[p],attachDirective:{}},K.d.al.ctrl?d.attachDirective["al-ctrl"]=f:d.attachDirective[f+"!"]=""),K.bind(n,e,d),n}K.exceptionHandler("Error in bootstrap","Error input arguments",{input:e})},K.utils.getId=(E=function(){var e,t,n,i,a;for(a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),n=Math.floor((new Date).valueOf()/1e3)-1388512800,i="";0<n;)t=n-62*(e=Math.floor(n/62)),n=e,i=a[t]+i;return i}(),T=1,function(){return E+"#"+T++}),K.utils.clone=L=function(i,a){var o,e,t,n;if(null==a&&(a=128),a<1)return null;if(!i)return i;if("object"==typeof i){if(i instanceof Array)return t=function(){var e,t,n;for(n=[],e=0,t=i.length;e<t;e++)o=i[e],n.push(L(o,a-1));return n}();if(i instanceof Date)return new Date(i.valueOf());if(i.nodeType&&"function"==typeof i.cloneNode)return i;for(e in t={},i)n=i[e],"$"!==e[0]&&(t[e]=L(n,a-1));return t}return i},K.utils.equal=B=function(e,t,n){var i,a,o,r,l,c,s;if(null==n&&(n=128),n<1)return!0;if(!e||!t)return e===t;if((c=typeof e)!==typeof t)return!1;if("object"===c){if(e instanceof Array){if(e.length!==t.length)return!1;for(i=a=0,r=e.length;a<r;i=++a)if(s=e[i],!B(s,t[i],n-1))return!1;return!0}if(e instanceof Date)return e.valueOf()===t.valueOf();if(e.nodeType&&"function"==typeof e.cloneNode)return e===t;for(o in l={},e)if(s=e[o],"$"!==o[0]&&(l[o]=!0,!B(s,t[o],n-1)))return!1;for(o in t)if(s=t[o],"$"!==o[0]&&!l[o]&&!B(s,e[o],n-1))return!1;return!0}return e===t},K.exceptionHandler=function(e,t,n){var i;return i=[],t&&i.push(t),e&&e.message&&i.push(e.message),n&&i.push(n),e&&i.push(e.stack?e.stack:e),console.error.apply(console,i)},H=(V=function(){var e,t,n;for(n={},e=0,t=arguments.length;e<t;e++)n[arguments[e]]=!0;return n})("instanceof","typeof","in","null","true","false","undefined","return"),R=/[a-zA-Z\u0410-\u044F\u0401\u0451_\.\$]/,I=function(e){return e.match(R)},M=function(e){return 48<=e.charCodeAt()&&e.charCodeAt()<=57},W=V("+","-",">","<","=","&","|","^","!","~"),z=function(e){return W[e]||!1},O=V("=","+=","-=","++","--","|=","^=","&=","!=","<<=",">>="),K.utils.parsExpression=function(e,t){var g,h,n,p,m,x,v,y,f,_;return m=V.apply(null,(t=t||{}).input||[]),_=1,n=(x=function(e){var t,n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k,w;for(d=e.line,g=e.result||[],u=e.index||0,f=e.level||0,v=e.stopKey||null,m=!(w=[]),s=b=y=l=h=k="",a=0,c=p=null,r=function(){return s&&g.push({type:"free",value:s}),s=""};u<=d.length;)if(i=d[u-1],t=d[u++]||"",n=d[u],(m&&s||!t)&&r(),"string"!==m){if("key"===m){if(I(t)||M(t)){k+=t;continue}if("["===t){if(k+=t,!(o=x({line:d,index:u,level:f+1,stopKey:"]"})).stopKeyOk)throw"Error expression";u=o.index,k+="###"+o.uniq+"###]",w.push(o);continue}if("?"===t&&("."===n||"("===n||"["===n)){k+=t;continue}if("("===t){if(k+=t,!(o=x({line:d,index:u,level:f+1,stopKey:")"})).stopKeyOk)throw"Error expression";u=o.index,k+="###"+o.uniq+"###)",w.push(o);continue}p={type:"key",value:k,start:u-k.length-1,finish:u-1,children:w},g.push(p),k=m="",w=[]}else if("sign"===m){if(z(t)){h+=t;continue}if("|"===h&&0===f&&0===a){c=d.substring(u-1),u=d.length+1;continue}(O[h]||"="===h[0]&&"="!==h[1])&&(p.assignment=!0),g.push({type:"sign",value:h}),h=m=""}else if("digit"===m){if(M(t)||"."===t){l+=t;continue}g.push({type:"digit",value:l}),l=""}if(I(t))m="key",k+=t;else if(z(t))m="sign",h+=t;else if(M(t))m="digit",l+=t;else if('"'!==t&&"'"!==t){if(t===v)return r(),{result:g,index:u,stopKeyOk:!0,uniq:_++};"("===t&&a++,")"===t&&a--,"{"!==t?(":"===t&&"}"===v&&(p.type="free"),s+=t):(r(),o=x({line:d,index:u,level:f+1,stopKey:"}"}),g.push({type:"{}",child:o}),u=o.index)}else m="string",b+=y=t}else{if(t===y&&"\\"!==i){b+=t,g.push({type:"string",value:b}),m=y=b="";continue}b+=t}return r(),{result:g,index:u,filter:c}})({line:e}),v={isSimple:!n.filter,simpleVariables:[]},n.filter?(v.expression=e.substring(0,e.length-n.filter.length-1),v.filter=n.filter):v.expression=e,y=function(e){var t;return{count:(t=e.split(/[\.\[\(\?]/)).length,firstPart:t[0]}},f=function(e,t){return t?"($$="+e+",$$==null)?undefined:":"($$=$$"+e+",$$==null)?undefined:"},p=function(e){return e.split(/[\.\[\(\?]/)[0]},h=function(e){var t,n,i,a,o,r,l,c,s,u;if("this"===e)return"$$scope";if(t=p(e),a=H[t]||m[t],"this"===t&&(e="$$scope"+e.slice(4),a=!0),1===(c=e.split("?")).length)return a?e:"$$scope."+e;for(a?(u=f(c[0],!0),n=c[0]):(u=f("scope."+c[0]),n="scope."+c[0]),i=0,r=(s=c.slice(1,c.length-1)).length;i<r;i++)"("===(l=s[i])[0]?u+=f(n+l,a):(u+=f(l),n+=l);return"("===(o=c[c.length-1])[0]?(a||(u+="$$"),u+=n+o):u+="$$"+o,"("+u+")"},g=function(e){var t,n,i,a,o,r,l,c,s,u,p,f,d;for(f="",a=0,l=(u=e.result).length;a<l;a++)if("key"!==(i=u[a]).type)"{}"!==i.type?f+=i.value:f+="{"+g(i.child)+"}";else{if(i.assignment?(s="this"===(d=y(i.value)).firstPart?"$$scope"+i.value.substring(4):m[d.firstPart]?i.value:d.count<2?"($$scope.$$root || $$scope)."+i.value:"$$scope."+i.value,v.isSimple=!1):H[i.value]?s=i.value:(s=h(i.value),v.simpleVariables.push(s)),i.children.length)for(o=0,c=(p=i.children).length;o<c;o++)r="###"+(t=p[o]).uniq+"###",n=g(t),s=s.split(r).join(n);f+=s}return f},v.result=g(n),K.debug.parser&&console.log(e,v),v},K.utils.parsFilter=function(e){var t,n,i;for(i=[],e=e.trim();e;){if(!(t=e.match(/^(\w+)([^\w])(.*)$/))){if(!(t=e.match(/^(\w+)$/)))return null;i.push({name:t[1],args:[],raw:""});break}"|"===t[2]?(i.push({name:t[1],args:[],raw:""}),e=t[3]):(n=K.utils.parsArguments(t[3],{stop:"|"}),i.push({name:t[1],args:n.result,raw:t[3].slice(0,n.length)}),e=t[3].slice(n.length+1).trim())}return{result:i}},K.utils.parsArguments=function(e,t){var n,i,a,o,r,l,c,s;for(t=t||{},i="",o=r=0,s=c=!(a=[]),l=function(){i&&(a.push(i),i="")};r<=e.length;)if(n=e[r]||"",r++,c)i+=n,'"'===n&&(c=!1);else if(s)i+=n,"'"===n&&(s=!1);else if('"'!==n)if("'"!==n)if(o)i+=n,"("===n&&o++,")"===n&&o--;else if(" "!==n&&","!==n){if(t.stop&&t.stop===n){l();break}"("===n&&(o=1),i+=n}else l();else i+=n,s=!0;else i+=n,c=!0;return l(),{result:a,length:r-1}},K.utils.pars_start_tag="{{",K.utils.pars_finish_tag="}}",Y=function(r){var l,c,s,u,n,p,f,a;return a=K.utils.pars_start_tag,l=K.utils.pars_finish_tag,p=[],n=s=0,c=function(e){var t;return e=e||1,t=r.substring(n,s-e),n=s,t},f=null,u=function(e,t,n){var i,a,o;for(e||(f={type:"expression",list:[]},p.push(f)),i=null;s<r.length;){if(a=i+(i=r[s]),o=r[s+=1],i===t)return;if(!n){if(a===l&&0===e)return f.list.push(c(2)),!0;"("===i?u(e+1,")"):"{"===i?u(e+1,"}"):'"'===i?u(e+1,'"',!0):"'"===i?u(e+1,"'",!0):"|"===i&&0===e&&("|"===o?s+=1:f.list.push(c()))}}},function(){var e,t,n,i;for(e=t=null;s<r.length;)if(t=e,e=r[s],s+=1,t+e===a){if((i=c(2))&&p.push({type:"text",value:i}),!u(0))throw"Wrong expression"+r;e=null}if(n=c(-1))p.push({type:"text",value:n})}(),K.debug.parser&&console.log("parsText",p),p},U={},J=function(i){var a,o;return function(){var e,t,n;for(n=[],e=0,t=i.length;e<t;e++)a=i[e],o={type:a.type,value:a.value},a.list&&(o.list=a.list.slice()),n.push(o);return n}()},K.utils.parsText=function(e){var t;return(t=U[e])||(U[e]=t=Y(e)),J(t)},K.utils.compile=X={},X.cache={},X.Function=Function,X.expression=function(t,n){var e,i,a,o,r,l,c;if(n=n||{},l=(t=t.trim())+"#",l+=n.no_return?"+":"-",l+=n.string?"s":"v",n.input&&(l+=n.input.join(",")),r=X.cache[l])return r;a=(r=K.utils.parsExpression(t,{input:n.input})).result,n.no_return?c="var $$;"+a:n.string&&!r.filter?(c="var $$, __ = ("+a+"); return '' + (__ || (__ == null?'':__))",r.rawExpression="(__="+a+") || (__ == null?'':__)"):c="var $$;return ("+a+")";try{n.input?((e=n.input.slice()).unshift("$$scope"),e.push(c),o=X.Function.apply(null,e)):o=X.Function("$$scope",c)}catch(e){throw i=e,K.exceptionHandler(i,"Wrong expression: "+t,{src:t,cfg:n}),"Wrong expression: "+a}return r.fn=o,X.cache[l]=r},X.cacheText={},X.buildText=function(e,t){var n,i,a,o,r,l,c;if(a=X.cacheText[e])return function(){return a.call(t)};for(c=[],r=o=0,l=t.length;o<l;r=++o)"expression"===(n=t[r]).type?n.fn?c.push("this["+r+"].fn(this.scope)"):c.push("((x=this["+r+"].value) || (x == null?'':x))"):n.value&&(i=n.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),c.push('"'+i+'"'));return c=c.join(" + "),a=X.Function("var x; return ("+c+")"),X.cacheText[e]=a,function(){return a.call(t)}},X.cacheSimpleText={},X.buildSimpleText=function(e,t){var n,i,a,o,r,l,c,s;if((r=e?X.cacheSimpleText[e]:null)||!t)return r||null;for(c=[],s=[],o=a=0,l=t.length;a<l;o=++a)"expression"===(n=t[o]).type?(c.push("("+n.re+")"),n.simpleVariables&&s.push.apply(s,n.simpleVariables)):n.value&&(i=n.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),c.push('"'+i+'"'));return c=c.join(" + "),r={fn:X.Function("$$scope","var $$, __; return ("+c+")"),simpleVariables:s},e&&(X.cacheSimpleText[e]=r),r},G=function(e){var t,n,i;if(!e.length)return"el";for(i="el",t=0,n=e.length;t<n;t++)i+=".childNodes["+e[t]+"]";return i},Z=function(e){var t,n,i,a,o,r;for(a=0,r=(i=K.utils.parsText(e)).length;a<r;a++)if("expression"===(n=i[a]).type){if(1<n.list.length)return null;if("#"===(o=n.list[0])[0])return null;if("="===o[0])return null;if("::"===o.slice(0,2))return null;if(!(t=K.utils.compile.expression(o,{string:!0})).rawExpression)throw"Error";n.re=t.rawExpression}return K.utils.compile.buildSimpleText(e,i).fn},K.core.fastBinding=function(e){if(K.option.fastBinding&&!e.directive&&!e.hook&&e.fb)return new q(e)},(q=function(e){var y,b,k,w;return k=[],(b=this).fastWatchFn=[],y=[],(w=function(e,t){var n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v;if(e.dir)for(h=G(y),o=0,s=(f=e.dir).length;o<s;o++)n=f[o],k.push("s.dir("+b.fastWatchFn.length+", "+h+");"),b.fastWatchFn.push(n);if(e.attr)for(r=0,u=(d=e.attr).length;r<u;r++)v=(a=d[r]).value,l=a.attrName,h=G(y),i=Z(v),m=v.replace(/"/g,'\\"').replace(/\n/g,"\\n"),i?(k.push('s.fw("'+m+'", '+b.fastWatchFn.length+", "+h+', "'+l+'");'),b.fastWatchFn.push(i)):k.push("s.wt('"+m+"', "+h+", '"+l+"');");if(e.text&&(h=G(y),i=Z(e.text),m=e.text.replace(/"/g,'\\"').replace(/\n/g,"\\n"),i?(k.push('s.fw("'+m+'", '+b.fastWatchFn.length+", "+h+");"),b.fastWatchFn.push(i)):k.push('s.wt("'+m+'", '+h+");")),e.children)for(c=0,p=(g=e.children).length;c<p;c++)a=g[c],y.length=t+1,y[t]=a.index,w(a.fb,t+1)})(e.fb,0),k=k.join("\n"),b.resultFn=K.utils.compile.Function("s","el","f$",k),this}).prototype.bind=function(e,t){this.currentCD=e,this.resultFn(this,t,ue)},q.prototype.dir=function(e,t){var n,i,a,o;i=this.fastWatchFn[e],n=this.currentCD,a=new A({attrName:i.attrName,attrArgument:i.attrArgument,changeDetector:n,fbData:i.fbData}),(o=i.fb.call(a,n.scope,t,i.value,a))&&o.start&&o.start()},q.prototype.fw=function(e,t,n,i){var a,o,r,l;a=this.currentCD,l={isStatic:!1,isArray:!1,extraLoop:!1,deep:!1,value:r=(o=this.fastWatchFn[t])(a.locals),callback:null,exp:o,src:e,onStop:null,el:n,ea:i||null},a.watchList.push(l),P(a.scope,l,r)},q.prototype.wt=function(e,t,n){this.currentCD.watchText(e,null,{element:t,elementAttr:n})},K.hooks.attribute.unshift({code:"events",fn:function(){var e;(e=this.attrName.match(/^\@([\w\.\-]+)$/))&&(this.ns="al",this.name="on",this.attrArgument=e[1])}}),K.hooks.eventModifier={},(re=function(e,n){return K.hooks.eventModifier[e]={event:["keydown","keypress","keyup"],fn:function(e,t){e[n]||(t.stop=!0)}}})("alt","altKey"),re("control","ctrlKey"),re("ctrl","ctrlKey"),re("meta","metaKey"),re("shift","shiftKey"),K.hooks.eventModifier.self=function(e,t){if(e.target!==t.element)return t.stop=!0},K.hooks.eventModifier.once={beforeExec:function(e,t){return t.unbind()}},te=function(e,t){var n,i,a,o,r,l;if(l={},"string"==typeof e?l.event=e:"object"==typeof e&&e.event&&(l.event=e.event),"string"==typeof l.event&&(l.event=l.event.split(/\s+/)),t&&l.event){for(a=!1,i=0,o=(r=l.event).length;i<o;i++)if(n=r[i],0<=t.indexOf(n)){a=!0;break}if(!a)return null}return ue.isFunction(e)?l.fn=e:e.fn&&(l.fn=e.fn),e.beforeExec&&(l.beforeExec=e.beforeExec),e.init&&(l.init=e.init),l},K.d.al.on=function(e,t,n,i){var u,a;i.attrArgument&&(K.option.removeAttribute&&(t.removeAttribute(i.attrName),i.fbElement&&i.fbElement.removeAttribute(i.attrName)),a=i.attrArgument.split(".")[0],(u=function(){}).prototype=oe(i.attrArgument,Q[a]),n&&(u.prototype.fn=i.changeDetector.compile(n,{no_return:!0,input:["$event","$element","$value"]})),u.prototype.expression=n,i.fastBinding=function(e,i,t,n){var a,o,r,l,c,s;for((r=new u).scope=e,r.element=i,r.cd=n.changeDetector,a=function(e){return ie(r,e)},l=0,c=(s=r.eventList).length;l<c;l++)o=s[l],ue.on(i,o,a);r.initFn&&r.initFn(e,i,t,n),r.unbind=function(){var e,t,n;for(e=0,t=(n=r.eventList).length;e<t;e++)o=n[e],ue.off(i,o,a)},n.changeDetector.watch("$destroy",r.unbind)},i.fastBinding(e,t,n,i))},ae={enter:13,tab:9,delete:46,backspace:8,esc:27,space:32,up:38,down:40,left:37,right:39},Q={click:{stop:!0,prevent:!0},dblclick:{stop:!0,prevent:!0},submit:{stop:!0,prevent:!0},keyup:{filterByKey:!0},keypress:{filterByKey:!0},keydown:{filterByKey:!0}},oe=function(e,t){var n,i,a,o,r,l,c,s,u;for(i={attrArgument:e,throttle:null,throttleTime:0,debounce:null,debounceId:null,initFn:null,eventList:null,stop:(t=t||{}).stop||!1,prevent:t.prevent||!1,scan:!0,modifiers:[]},a=(n=e.split("."))[0],o=null,(s=K.hooks.eventModifier[a])&&(s=te(s)).event&&(i.eventList=s.event,s.fn&&i.modifiers.push(s),s.init&&(i.initFn=s.init)),i.eventList||(i.eventList=[a]),r=0,c=(u=n.slice(1)).length;r<c;r++)"stop"!==(l=u[r])?"prevent"!==l?"nostop"!==l?"noprevent"!==l?"noscan"!==l?"throttle-"!==l.substring(0,9)?"debounce-"!==l.substring(0,9)?(s=K.hooks.eventModifier[l])?(s=te(s,i.eventList))&&i.modifiers.push(s):t.filterByKey&&(null===o&&(o={}),ae[l]&&(l=ae[l]),o[l]=!0):i.debounce=Number(l.substring(9)):i.throttle=Number(l.substring(9)):i.scan=!1:i.prevent=!1:i.stop=!1:i.prevent=!0:i.stop=!0;return i.filterByKey=o,i},ne=function(e,t){var n;return"checkbox"===(n=e.element).type?n.checked:"radio"===n.type?n.value||n.checked:t.component?t.value:n.value},ee=function(t,n){var i,e,a,o,r;for(e=0,a=(r=t.modifiers).length;e<a;e++)(o=r[e]).beforeExec&&o.beforeExec(n,t);if(t.fn)try{t.fn(t.cd.locals,n,t.element,ne(t,n))}catch(e){i=e,K.exceptionHandler(i,"Error in event: "+t.attrArgument+" = "+t.expression,{attr:t.attrArgument,exp:t.expression,scope:t.scope,cd:t.cd,element:t.element,event:n})}t.scan&&t.cd.scan()},ie=function(e,t){var n,i,a,o,r,l;if(!e.filterByKey||e.filterByKey[t.keyCode]){if(e.modifiers.length)for((n=function(){}).prototype=e,(i=new n).stop=!1,a=0,o=(l=e.modifiers).length;a<o;a++)if((r=l[a]).fn&&(r.fn(t,i),i.stop))return;e.prevent&&t.preventDefault(),e.stop&&t.stopPropagation(),e.debounce?(e.debounceId&&clearTimeout(e.debounceId),e.debounceId=setTimeout(function(){return e.debounceId=null,ee(e,t)},e.debounce)):e.throttle?e.throttleTime<Date.now()&&(e.throttleTime=Date.now()+e.throttle,ee(e,t)):ee(e,t)}},K.hooks.attribute.unshift({code:"directDirective",fn:function(){var e=this.attrName.match(/^(.*)\!$/);if(e){var t=e[1].replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}),c=this.cd.locals[t]||K.ctrl[t]||K.option.globalController&&window[t];ue.isFunction(c)?this.directive=function(e,t,n,i){var a=i.changeDetector;if(n){for(var o=K.utils.parsArguments(n),r=Array(o.result.length),l=0;l<o.result.length;l++)r[l]=K.utils.compile.expression(o.result[l],{input:["$element","$env"]}).fn(a.locals,t,i);c.apply(a,r)}else c.call(a,e,t,n,i)}:(this.result="noDirective",this.stop=!0)}}}),K.hooks.attribute.unshift({code:"elementVariable",fn:function(){var e=this.attrName.match(/^#([\w\.]*)$/);e&&(this.directive=de,this.attrArgument=e[1])}}),K.d.al.value=function(e,t,n,i){var a,o;return i.fastBinding=!0,a=function(){i.setValue(n,t.value),o.refresh(),i.scan()},i.on(t,"input",a),i.on(t,"change",a),o=i.watch(n,function(e){return null==e&&(e=""),t.value=e,"$scanNoChanges"})},K.d.al.checked=function(e,n,t,i){var a=i.fbData={opt:{},watch:[]};function o(e){var t=i.takeAttr(e);return K.option.removeAttribute&&(n.removeAttribute(e),i.fbElement&&i.fbElement.removeAttribute(e)),t}function r(e,t){var n=o(t);if(n)return a.opt[e]=n,!0;var i=o(":"+t)||o("al-attr."+t);return i?(a.watch.push([i,e]),!0):void 0}function c(n,i,a){for(var e in i.fbData.opt)n[e]=i.fbData.opt[e];for(var t=function(e){var t=e[1];i.watch(e[0],function(e){n[t]=e,a()})},o=0,r=i.fbData.watch;o<r.length;o++){t(r[o])}}r("value","value")?i.fastBinding=function(e,t,n,i){var a,o=null;function r(){return t.checked=o&&0<=o.indexOf(l.value),"$scanNoChanges"}var l={};c(l,i,r),a=i.watch(n,function(e){o=e,Array.isArray(o)||(o=null),r()},{isArray:!0}),i.on(t,"change",function(){if(o||(o=[],i.setValue(n,o)),t.checked)o.indexOf(l.value)<0&&o.push(l.value);else{var e=o.indexOf(l.value);0<=e&&o.splice(e,1)}a.refresh(),i.scan()})}:(r("true","true-value"),r("false","false-value"),i.fastBinding=function(e,t,n,i){var a,o,r={true:!0,false:!1};function l(){return t.checked=a===r.true,"$scanNoChanges"}c(r,i,l),o=i.watch(n,function(e){a=e,l()}),i.on(t,"change",function(){a=t.checked?r.true:r.false,i.setValue(n,a),o.refresh(),i.scan()})}),i.fastBinding(e,n,t,i)},K.d.al.if=function(e,t,n,i){var a;return i.elementCanBeRemoved?(K.exceptionHandler(null,i.attrName+" can't control element because of "+i.elementCanBeRemoved,{scope:e,element:t,value:n,env:i}),{}):(i.stopBinding=!0,a={item:null,childCD:null,base_element:null,top_element:null,start:function(){a.prepare(),a.watchModel()},prepare:function(){a.base_element=t,a.top_element=document.createComment(" "+i.attrName+": "+n+" "),ue.before(t,a.top_element),ue.remove(t)},updateDom:function(e){e?a.insertBlock(e):a.removeBlock()},removeBlock:function(){a.childCD&&(a.childCD.destroy(),a.childCD=null,a.removeDom(a.item),a.item=null)},insertBlock:function(){a.childCD||(a.item=a.base_element.cloneNode(!0),a.insertDom(a.top_element,a.item),a.childCD=i.changeDetector.new(),K.bind(a.childCD,a.item,{skip_attr:i.skippedAttr(),elementCanBeRemoved:i.attrName}))},watchModel:function(){i.watch(n,a.updateDom)},removeDom:function(e){ue.remove(e)},insertDom:function(e,t){ue.after(e,t)}})},K.d.al.ifnot=function(e,t,n,i){var a;return(a=K.d.al.if(e,t,n,i)).updateDom=function(e){e?a.removeBlock():a.insertBlock()},a},K.directives.al.repeat={restrict:"AM",init:function(e,D,o,U){var l,J;return U.elementCanBeRemoved?(K.exceptionHandler(null,U.attrName+" can't control element because of "+U.elementCanBeRemoved,{scope:e,element:D,value:o,env:U}),{}):(U.stopBinding=!0,l=U.changeDetector,J={start:function(){J.parsExpression(),J.prepareDom(),J.buildUpdateDom(),J.watchModel()},parsExpression:function(){var e,t;if("("===(t=o.trim())[0])if(J.objectMode=!0,e=t.match(/\((\w+),\s*(\w+)\)\s+in\s+(.+)\s+orderBy:(.+)\s*$/))J.objectKey=e[1],J.objectValue=e[2],J.expression=e[3]+" | toArray:"+J.objectKey+","+J.objectValue+" | orderBy:"+e[4],J.nameOfKey="$item",J.trackExpression="$item."+J.objectKey;else{if(!(e=t.match(/\((\w+),\s*(\w+)\)\s+in\s+(.+)\s*$/)))throw"Wrong repeat: "+o;J.objectKey=e[1],J.objectValue=e[2],J.expression=e[3]+" | toArray:"+J.objectKey+","+J.objectValue,J.nameOfKey="$item",J.trackExpression="$item."+J.objectKey}else{if((e=t.match(/(.*) track by ([\w\.\$\(\)]+)/))&&(J.trackExpression=e[2],t=e[1]),!(e=t.match(/\s*(\w+)\s+in\s+(.+)/)))throw"Wrong repeat: "+o;J.nameOfKey=e[1],J.expression=e[2]}},watchModel:function(){var e;e=J.objectMode?{deep:!0}:{isArray:!0},J.watch=l.watch(J.expression,J.updateDom,e)},prepareDom:function(){var e,t,n,i,a;if(8===D.nodeType){for(J.top_element=D,J.element_list=t=[],e=D.nextSibling;e;){if(8===e.nodeType&&"/directive:"===(a=e.nodeValue.trim().split(/\s+/))[0]&&"al-repeat"===a[1]){U.skipToElement=e;break}t.push(e),e=e.nextSibling}for(n=0,i=t.length;n<i;n++)e=t[n],ue.remove(e)}else J.base_element=D,J.top_element=document.createComment(" "+o+" "),ue.before(D,J.top_element),ue.remove(D),K.option.removeAttribute&&D.removeAttribute(U.attrName)},makeChild:function(e,t,n){var i;return i=l.new(null,{locals:!0}),J.updateLocals(i,e,t,n),i},updateLocals:function(e,t,n,i){var a;a=e.locals,J.objectMode?(a[J.objectKey]=t[J.objectKey],a[J.objectValue]=t[J.objectValue]):a[J.nameOfKey]=t,a.$index=n,a.$first=0===n,a.$last=n===i.length-1},rawUpdateDom:function(e,t){var n,i,a,o,r,l;for(i=0,r=e.length;i<r;i++)n=e[i],ue.remove(n);for(o=0,l=t.length;o<l;o++)a=t[o],ue.after(a.after,a.element)},buildUpdateDom:function(){return J.updateDom=(R=[],_=null,C=M=0,W=U.skippedAttr(),"$index"===J.trackExpression?(r={},H=function(e){return r[M]||null},z=function(e){null!=e.$id&&delete r[e.$id]},V=function(e,t){t.$id=M,r[M]=t}):J.trackExpression?(r={},n=l.compile(J.trackExpression,{input:["$id",J.nameOfKey]}),i=function(e,t){return n(l.scope,e,t)},a=function(e){var t;return(t=e.$alite_id)?t:t=e.$alite_id=K.utils.getId()},H=function(e){var t;return null!=(t=i(a,e))?r[t]:null},z=function(e){var t;null!=(t=e.$id)&&delete r[t]},V=function(e,t){var n;n=i(a,e),t.$id=n,r[n]=t}):window.Map?(r=new Map,H=function(e){return r.get(e)},z=function(e){r.delete(e.item)},V=function(e,t){r.set(e,t)}):(r={},H=function(e){var t;return"object"!=typeof e?r[e]||null:(t=e.$alite_id)?r[t]:null},z=function(e){var t;t=e.$id,r[t]&&(e.$id=null,delete r[t])},V=function(e,t){var n;"object"==typeof e?(n=K.utils.getId(),e.$alite_id=n,t.$id=n,r[n]=t):(t.$id=e,r[e]=t)}),o=[],I=function(e){var t,n;if("object"!=(n=typeof e)){if("number"===n)t=Math.floor(e);else if("string"===n&&(t=Math.floor(e),isNaN(t)))return[];if(t<o.length)o.length=t;else for(;o.length<t;)o.push(o.length);return o}return e&&e.length?e:[]},J.element_list?function(e){var a,o,r,l,t,c,n,i,s,u,p,f,d,g,h,m,v,y,b,k,w,x,_,C,D,S,L,B,T,E,A,P,F,N,$,j,O;for(D=I(e),m=J.top_element,l=[],E=[],s=0,v=R.length;s<v;s++)(T=R[s]).active=!1;for(M=d=0,y=D.length;d<y;M=++d)p=D[M],(T=H(p))&&(T.active=!0);for(t=[],g=0,b=R.length;g<b;g++)if(!(T=R[g]).active){for(T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),z(T),T.CD.destroy(),h=0,k=($=T.element_list).length;h<k;h++)c=$[h],t.push(c);T.next=null,T.prev=null,T.element_list=null}for(N=null,F=!(a=[]),n=J.element_list.length-1,M=S=0,w=D.length;S<w;M=++S)if(p=D[M],T=H(f=p)){if(J.updateLocals(T.CD,p,M,D),T.prev===N){if(F)for(L=0,x=(j=T.element_list).length;L<x;L++)c=j[L],l.push({element:c,after:m}),m=c;m=(N=T).element_list[n],T.active=!0,E.push(T);continue}for((T.prev=N)&&(N.next=T),A=0,_=(O=T.element_list).length;A<_;A++)c=O[A],l.push({element:c,after:m}),m=c;F=!0,(N=T).active=!0,E.push(T)}else r=J.makeChild(f,M,D),i=function(){var e,t,n,i;for(i=[],t=0,e=(n=J.element_list).length;t<e;t++)o=n[t],c=o.cloneNode(!0),a.push({cd:r,el:c}),l.push({element:c,after:m}),i.push(m=c);return i}(),V(p,T={CD:r,element_list:i,prev:N,next:null,active:!0,item:p}),N?(B=N.next,((N.next=T).next=B)&&(B.prev=T)):0===M&&R[0]&&(B=R[0],(T.next=B).prev=T),N=T,E.push(T);for(R=E,J.rawUpdateDom(t,l),t.length=0,P=l.length=0,C=a.length;P<C;P++)u=a[P],K.bind(u.cd,u.el,{skip_attr:W,elementCanBeRemoved:U.attrName,noDomOptimization:!0})}:function(e){var t,n,i,a,o,r,l,c,s,u,p,f,d,g,h,m,v,y,b,k,w,x;for(m=I(e),f=J.top_element,C++,i=[],b=[],w=null,k=!(t=[]),M=r=0,d=m.length;r<d;M=++r)if(c=m[M],y=H(s=c)){if(J.updateLocals(y.CD,c,M,m),y.prev===w){k&&i.push({element:y.element,after:w.element}),f=(w=y).element,y.version=C,b.push(y);continue}(y.prev=w)&&(w.next=y),i.push({element:y.element,after:f}),k=!0,f=y.element,(w=y).version=C,b.push(y)}else n=J.makeChild(s,M,m),D=J.base_element.cloneNode(!0),null===_?(o=J.base_element.cloneNode(!0),x=K.bind(n,D,{skip_attr:W,elementCanBeRemoved:U.attrName,noDomOptimization:!0,fbElement:o}),(_=K.core.fastBinding(x)||!1)&&(J.base_element=o)):t.push({cd:n,el:D}),i.push({element:D,after:f}),V(c,y={CD:n,element:f=D,prev:w,next:null,version:C,item:c}),w?(v=w.next,((w.next=y).next=v)&&(v.prev=y)):0===M&&R[0]&&(v=R[0],(y.next=v).prev=y),w=y,b.push(y);for(a=[],u=0,g=R.length;u<g;u++)(y=R[u]).version!==C&&(y.prev&&(y.prev.next=y.next),y.next&&(y.next.prev=y.prev),z(y),y.CD.destroy(),a.push(y.element),y.next=null,y.prev=null,y.element=null);for(R=b,J.rawUpdateDom(a,i),a.length=0,p=i.length=0,h=t.length;p<h;p++)l=t[p],_?_.bind(l.cd,l.el):K.bind(l.cd,l.el,{skip_attr:W,elementCanBeRemoved:U.attrName,noDomOptimization:!0})});var i,a,_,o,I,M,r,z,H,V,R,W,C,n}})}},K.d.al.init=function(t,n,i,a){var o,r,e,l,c;K.option.removeAttribute&&(n.removeAttribute(a.attrName),a.fbElement&&a.fbElement.removeAttribute(a.attrName)),o=a.changeDetector,c=["$element"],"window"===a.attrArgument&&c.push("window");try{l=o.compile(i,{no_return:!0,input:c}),a.fastBinding=e=function(e,t,n,i){return l(i.changeDetector.locals,t,window)},e(0,n,0,a)}catch(e){r=e,K.exceptionHandler(r,"al-init, error in expression: "+i,{exp:i,scope:t,cd:o,element:n}),a.fastBinding=function(){}}},K.d.al.app={stopBinding:!0},K.d.al.stop={restrict:"AE",stopBinding:!0},K.d.al.cloak=function(e,t,n,i){t.removeAttribute(i.attrName),n&&ue.removeClass(t,n)},K.d.al.html={restrict:"AM",priority:100,modifier:{},link:function(a,o,r,l){var c;return l.elementCanBeRemoved&&8!==o.nodeType?(K.exceptionHandler(null,l.attrName+" can't control element because of "+l.elementCanBeRemoved,{scope:a,element:o,value:r,env:l}),{}):(l.stopBinding=!0,c={baseElement:null,topElement:null,activeElement:null,childCD:null,name:r,watchMode:null,start:function(){c.parsing(),c.prepare(),c.watchModel()},parsing:function(){var e,t,n,i;if(l.attrArgument)for(e=0,t=(i=l.attrArgument.split(".")).length;e<t;e++)"literal"!==(n=i[e])?"tpl"!==n?K.d.al.html.modifier[n]&&K.d.al.html.modifier[n](c,{scope:a,element:o,inputName:r,env:l}):c.watchMode="tpl":c.watchMode="literal"},prepare:function(){8===o.nodeType?(c.baseElement=null,c.topElement=o):(c.baseElement=o,c.topElement=document.createComment(" "+l.attrName+": "+r+" "),ue.before(o,c.topElement),ue.remove(o))},removeBlock:function(){var e,t,n,i;if(c.childCD&&(c.childCD.destroy(),c.childCD=null),c.activeElement){if(Array.isArray(c.activeElement))for(t=0,n=(i=c.activeElement).length;t<n;t++)e=i[t],c.removeDom(e);else c.removeDom(c.activeElement);c.activeElement=null}},insertBlock:function(e){var t,n,i;if(c.baseElement)c.activeElement=c.baseElement.cloneNode(!1),c.activeElement.innerHTML=e,c.insertDom(c.topElement,c.activeElement),c.childCD=l.changeDetector.new(),K.bind(c.childCD,c.activeElement,{skip_attr:l.skippedAttr(),elementCanBeRemoved:l.attrName});else for((i=document.createElement("body")).innerHTML=e,t=c.topElement,c.activeElement=[],c.childCD=l.changeDetector.new();n=i.firstChild;)c.insertDom(t,n),t=n,c.activeElement.push(n),K.bind(c.childCD,t,{skip_attr:l.skippedAttr(),elementCanBeRemoved:l.attrName})},updateDom:function(e){c.removeBlock(),e&&c.insertBlock(e)},removeDom:function(e){ue.remove(e)},insertDom:function(e,t){ue.after(e,t)},watchModel:function(){"literal"===c.watchMode?c.updateDom(c.name):"tpl"===c.watchMode?l.watchText(c.name,c.updateDom):l.watch(c.name,c.updateDom)}})}},K.d.al.html.modifier.id=function(i){return i.updateDom=function(e){var t,n;i.removeBlock(),(n=document.getElementById(e))&&(t=n.innerHTML)&&i.insertBlock(t)}},K.d.al.html.modifier.url=function(t){return t.loadHtml=function(e){ue.ajax(e)},t.updateDom=function(e){e?t.loadHtml({cache:!0,url:e,success:function(e){t.removeBlock(),t.insertBlock(e)},error:t.removeBlock}):t.removeBlock()}},K.d.al.html.modifier.scope=function(a,o){var e,r,l;if(2===(e=a.name.split(":")).length)a.name=e[0],l=e[1];else{if(e=a.name.match(/(.+)\:\s*\:\:([\d\w]+)$/))r=!0;else if(r=!1,!(e=a.name.match(/(.+)\:\s*([\.\w]+)$/)))throw"Wrong expression "+a.name;a.name=e[1],l=e[2]}return"outer",a.insertBlock=function(e){var t,n,i;a.activeElement=a.baseElement.cloneNode(!1),a.activeElement.innerHTML=e,a.insertDom(a.topElement,a.activeElement),n=o.env.changeDetector,(t=a.childCD=n.new(null,{locals:!0})).locals.outer=null,i=n.watch(l,function(e){return t.locals.outer=e},{oneTime:r}),a.childCD.watch("$destroy",function(){return i.stop()}),K.bind(a.childCD,a.activeElement,{skip_attr:o.env.skippedAttr()})}},K.d.al.html.modifier.inline=function(e,t){var n;return n=e.prepare,e.prepare=function(){return n(),t.env.setValue(e.name,e.baseElement.innerHTML)}},K.d.al.radio=function(e,t,n,i){var a,o,r;return a=i.takeAttr("al-value"),o=a?i.eval(a):i.takeAttr("value"),i.on(t,"change",function(){i.setValue(n,o),r.refresh(),i.scan()}),r=i.watch(n,function(e){return t.checked=o===e,"$scanNoChanges"})},window.Map?((le=function(){return this.idByItem=new Map,this.itemById={},this.index=1,this}).prototype.acquire=function(e){var t;return t="i"+this.index++,this.idByItem.set(e,t),this.itemById[t]=e,t},le.prototype.release=function(e){var t;t=this.itemById[e],delete this.itemById[e],this.idByItem.delete(t)},le.prototype.replace=function(e,t){var n;n=this.itemById[e],this.idByItem.delete(n),this.idByItem.set(t,e),this.itemById[e]=t},le.prototype.getId=function(e){return this.idByItem.get(e)},le.prototype.getItem=function(e){return this.itemById[e]||null}):((le=function(){return this.itemById={"i#null":null},this}).prototype.acquire=function(e){var t;return null===e?"i#null":("object"==typeof e?(t=e.$alite_id)||(e.$alite_id=t=K.utils.getId()):t=""+e,this.itemById[t]=e,t)},le.prototype.release=function(e){delete this.itemById[e]},le.prototype.replace=function(e,t){this.itemById[e]=t},le.prototype.getId=function(e){return null===e?"i#null":"object"==typeof e?e.$alite_id:""+e},le.prototype.getItem=function(e){return this.itemById[e]||null}),K.d.al.select=function(e,n,t,i){var a,o,r,l,c,s;return a=i.changeDetector.new(),i.stopBinding=!0,a.$select={mapper:r=new le},o=null,a.$select.change=function(){return K.nextTick(function(){return c(o)})},c=function(e){var t;return(t=r.getId(e))?n.value=t:n.selectedIndex=-1},s=a.watch(t,function(e){return c(o=e)}),l=function(e){return o=r.getItem(e.target.value),a.setValue(t,o),s.refresh(),a.scan()},i.on(n,"input",l),i.on(n,"change",l),K.bind(a,n,{skip_attr:i.skippedAttr()})},K.d.al.option=function(e,t,n,i){var a,o,r,l,c,s;for(a=s=i.changeDetector,r=0;r<=4&&!(c=s.$select);++r)s=s.parent||{};c?(l=c.mapper,o=null,a.watch(n,function(e){o?l.getId(e)!==o?(l.release(o),o=l.acquire(e),t.value=o,c.change()):l.replace(o,e):(o=l.acquire(e),t.value=o,c.change())}),a.watch("$destroy",function(){return l.release(o),c.change()})):K.exceptionHandler("","Error in al-option - al-select is not found",{cd:a,scope:a.scope,element:t,value:n})},K.hooks.attribute.unshift({code:"attribute",fn:function(){var e,t;(e=this.attrName.match(/^\:([\w\.\-]+)$/))&&("html"===(t=e[1]).split(".")[0]?(this.name="html",t=t.substring(5)):this.name="attr",this.ns="al",this.attrArgument=t)}}),ce={checked:"checked",readonly:"readOnly",value:"value",selected:"selected",muted:"muted",disabled:"disabled",hidden:"hidden"},K.d.al.attr=function(e,t,a,n){var o,r,i,l,c,s,u,p,f,d;if(n.attrArgument){if(i=n.attrArgument.split("."),r=i[0],u=ce[r],c=0<i.indexOf("tpl"),K.option.removeAttribute&&(t.removeAttribute(n.attrName),n.fbElement&&n.fbElement.removeAttribute(n.attrName)),o={readOnly:!0},p=null,"style"===r){if(!i[1])throw"Style is not declared";f=i[1].replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}),p=function(e,t){return null==t&&(t=""),e.style[f]=t}}else"class"===r&&1<i.length?(c=!1,s=i.slice(1),p=function(e,t){var n,i,a,o,r;if(t)for(i=0,o=s.length;i<o;i++)n=s[i],ue.addClass(e,n);else for(a=0,r=s.length;a<r;a++)n=s[a],ue.removeClass(e,n)}):"focus"===r?p=function(e,t){return t?e.focus():e.blur()}:u?p=function(e,t){if(void 0===t&&(t=null),e[u]!==t)return e[u]=t}:(o.element=t,o.elementAttr=r);d=c?"watchText":"watch",(l=p?function(e,t,n,i){return i.changeDetector[d](a,function(e){return p(t,e)},o)}:function(e,t,n,i){return i.changeDetector[d](a,null,{readOnly:!0,element:t,elementAttr:r})})(e,t,a,n),n.fastBinding=l}},K.d.al.model=function(e,t,n,i){var a;if("select"===(a=t.nodeName.toLowerCase()))return K.d.al.select.call(this,e,t,n,i);if("input"===a){if("checkbox"===t.type)return K.d.al.checked.call(this,e,t,n,i);if("radio"===t.type)return K.d.al.radio.call(this,e,t,n,i)}return K.d.al.value.call(this,e,t,n,i)},K.filters.slice=function(e,t,n){return e?n?e.slice(t,n):e.slice(t):null},se=function(e){return e<10?"0"+e:""+e},K.filters.date=function(e,t){var n,i,a,o,r;if(!e)return"";for(o=t,i=0,a=(r=[[/yyyy/g,(e=new Date(e)).getFullYear()],[/mm/g,se(e.getMonth()+1)],[/dd/g,se(e.getDate())],[/HH/g,se(e.getHours())],[/MM/g,se(e.getMinutes())],[/SS/g,se(e.getSeconds())]]).length;i<a;i++)n=r[i],o=o.replace(n[0],n[1]);return o},K.filters.json={watchMode:"deep",fn:function(e){return JSON.stringify(K.utils.clone(e),null,4)}},K.filters.filter=function(e,t,n){var i,a,o,r,l,c,s,u,p,f,d;if(2===arguments.length)l=null,d=t;else{if(3!==arguments.length)return e;l=t,d=n}if(!e||null==d||""===d)return e;if(u=[],p=(""+d).toLowerCase(),l)for(a=0,c=e.length;a<c;a++)(i=e[a])[l]===d?u.push(i):0<=(""+i[l]).toLowerCase().indexOf(p)&&u.push(i);else for(o=0,s=e.length;o<s;o++)for(r in i=e[o])(f=i[r])===d?u.push(i):0<=(""+f).toLowerCase().indexOf(p)&&u.push(i);return u},K.filters.orderBy=function(e,n,i){return!e instanceof Array?null:(i=i?1:-1,e.sort(function(e,t){return e[n]<t[n]?-i:e[n]>t[n]?i:0}))},K.filters.throttle={init:function(e,t,n){var i;return t=Number(t),i=null,{onChange:function(e){return i&&clearTimeout(i),i=setTimeout(function(){return i=null,n.setValue(e),n.changeDetector.scan()},t)}}}},K.filters.toArray={init:function(e,t,a){var o,r,l;return 2===a.conf.args.length?(o=a.conf.args[0],l=a.conf.args[1]):(o="key",l="value"),r=[],{watchMode:"deep",onChange:function(e){var t,n,i;for(n in r.length=0,e)i=e[n],(t={})[o]=n,t[l]=i,r.push(t);return a.setValue(r)}}}},K.filters.storeTo={init:function(e,t,n){return{onChange:function(e){return n.changeDetector.setValue(t,e),n.setValue(e)}}}},K.text["="]=function(e,t,n,i){var a;if((a=K.utils.compile.expression(t)).filters)throw"Conflict: bindonce and filters, use one-time binding";i.finally(a.fn(i.changeDetector.locals))},K.text["::"]=function(e,t,n,i){i.changeDetector.watch(t,function(e){return i.finally(e)},{oneTime:!0})},function(){var B=K.f$;function c(e){return e.replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()})}function T(e){var t,n=e.listener,i=e.childCD,a=e.name,o=e.parentName,r=e.parentCD,l={};if(a=c(a),n&&!0!==n)if(B.isFunction(n))t=n;else{if(t=n.onChange,"copy"===n||"copy"===n.watchMode)return void(t?t(o):i.scope[a]=o);"array"!==n&&"array"!==n.watchMode||(l.isArray=!0),"deep"!==n&&"deep"!==n.watchMode||(l.deep=!0)}t||(t=function(e){i.scope[a]=e,i.scan()}),r.watch(o,t,l)}K.component=function(S,L){var e,t,n=S.match(/^(\w+)[\-](.+)$/);n?(e=n[1],t=n[2]):(e="$global",t=S),t=c(t),K.d[e]||(K.d[e]={}),K.d[e][t]={restrict:"E",stopBinding:!0,priority:K.priority.$component,init:function(e,i,t,n){var a={$sendEvent:function(e,t){var n=new CustomEvent(e);n.value=t,n.component=!0,i.dispatchEvent(n)}},o=n.changeDetector.new(),r=K.ChangeDetector(a),l=new A({element:i,attributes:n.attributes,changeDetector:r,parentChangeDetector:o});try{var c=L.call(r,a,i,l)||{}}catch(e){return void K.exceptionHandler(e,"Error in component <"+S+">: ",{element:i,scope:a,cd:r})}c.onStart&&r.watch("$finishBinding",function(){c.onStart(),r.scan()});var s=!1;o.watch("$destroy",function(){s=!0,r.destroy()}),r.watch("$destroy",function(){c.onDestroy&&c.onDestroy(),s||o.destroy()});for(var u=0,p=i.attributes;u<p.length;u++){if("#"===(b=p[u]).name[0]){var f=b.name.slice(1);if(f){c.api?o.setValue(f,c.api):o.setValue(f,a);break}}}function d(e,t){var n=":"+e,i=l.takeAttr(n);if(!i){if(!(i=l.takeAttr(e)))return;t="copy"}T({childCD:r,listener:t,name:e,parentName:i,parentCD:o})}if(c.props)if(Array.isArray(c.props))for(var g=0,h=c.props;g<h.length;g++){d(m=h[g],!0)}else for(var m in c.props)d(m,c.props[m]);else for(var v=0,y=i.attributes;v<y.length;v++){var b,k=(b=y[v]).name,w=b.value;if(w){var x=k.match(/^\:(.*)$/);x&&T({childCD:r,name:x[1],parentName:w,parentCD:o})}}var _=!1;if(o.watch("$onScanOnce",function(){return _=!0}),c.template&&(i.innerHTML=c.template),c.templateId){var C=document.getElementById(c.templateId);if(!C)throw"No template "+c.templateId;i.innerHTML=C.innerHTML}function D(e){_||o.digest(),K.bind(r,i,{skip:!0})}c.templateUrl?B.ajax({url:c.templateUrl,cache:!0,success:function(e){i.innerHTML=e,D(!0)},error:function(){console.error("Template is not loaded",c.templateUrl)}}):D()}}}}(),K}var t=e();t.makeInstance=e,"function"==typeof alightInitCallback?alightInitCallback(t):"function"==typeof define?define(function(){return t}):"object"==typeof module&&"object"==typeof module.exports?module.exports=t:(t.option.globalController=!0,(window.alight=t).f$.ready(t.bootstrap))}()}(jQuery);